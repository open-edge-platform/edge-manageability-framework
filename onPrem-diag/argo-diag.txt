looking up argo IP and port
looking up argocd:argocd-server IP
found GenericIP: 192.168.99.20 for argocd:argocd-server
found argo IP: 192.168.99.20
argoIP: 192.168.99.20 argoPort: 443
logging in to ArgoCD
'admin:login' logged in successfully
Context '192.168.99.20:443' updated
=== BEGIN Argo CD Application List ===
NAME                                     CLUSTER                         NAMESPACE             PROJECT  STATUS  HEALTH       SYNCPOLICY  CONDITIONS  REPO                                                                PATH                              TARGET
onprem/alerting-monitor                  https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.7.4
onprem/app-deployment-crd                https://kubernetes.default.svc  orch-app              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     2.6.0
onprem/app-deployment-manager            https://kubernetes.default.svc  orch-app              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     2.6.0
onprem/app-deployment-manager-secret     https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.2
onprem/app-orch-catalog                  https://kubernetes.default.svc  orch-app              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     0.16.0
onprem/app-orch-tenant-controller        https://kubernetes.default.svc  orch-app              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     0.5.0
onprem/app-resource-manager              https://kubernetes.default.svc  orch-app              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     2.6.0
onprem/app-service-proxy                 https://kubernetes.default.svc  orch-app              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.6.0
onprem/auth-service                      https://kubernetes.default.svc  orch-gateway          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.0.1
onprem/capi-operator                     https://kubernetes.default.svc  capi-operator-system  onprem   Synced  Healthy      Auto-Prune  <none>      https://kubernetes-sigs.github.io/cluster-api-operator                                                0.23.0
onprem/capi-operator-pre                 https://kubernetes.default.svc  capi-variables        onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.0.1
onprem/capi-providers-config             https://kubernetes.default.svc  capi-operator-system  onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.2
onprem/cert-manager                      https://kubernetes.default.svc  cert-manager          onprem   Synced  Healthy      Auto-Prune  <none>      https://charts.jetstack.io                                                                            1.17.4
onprem/certificate-file-server           https://kubernetes.default.svc  orch-gateway          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.3
onprem/cluster-connect-gateway           https://kubernetes.default.svc  orch-cluster          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.2.5
onprem/cluster-manager                   https://kubernetes.default.svc  orch-cluster          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     2.2.6
onprem/component-status                  https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.0.3
onprem/copy-app-gitea-cred-to-fleet      https://kubernetes.default.svc  fleet-default         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/copy-ca-cert-boots-to-gateway     https://kubernetes.default.svc  orch-gateway          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/copy-ca-cert-boots-to-infra       https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/copy-ca-cert-gateway-to-cattle    https://kubernetes.default.svc  cattle-system         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/copy-ca-cert-gateway-to-infra     https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/copy-ca-cert-gitea-to-app         https://kubernetes.default.svc  orch-app              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/copy-ca-cert-gitea-to-cluster     https://kubernetes.default.svc  orch-cluster          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/copy-cluster-gitea-cred-to-fleet  https://kubernetes.default.svc  fleet-default         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/copy-keycloak-admin-to-infra      https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/edgenode-dashboards               https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     0.3.9
onprem/edgenode-observability            https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     0.10.18
onprem/external-secrets                  https://kubernetes.default.svc  orch-secret           onprem   Synced  Healthy      Auto-Prune  <none>      https://charts.external-secrets.io                                                                    0.20.4
onprem/fleet-controller                  https://kubernetes.default.svc  cattle-fleet-system   onprem   Synced  Healthy      Auto-Prune  <none>      https://rancher.github.io/fleet-helm-charts/                                                          0.12.8
onprem/fleet-crd                         https://kubernetes.default.svc  cattle-fleet-system   onprem   Synced  Healthy      Auto-Prune  <none>      https://rancher.github.io/fleet-helm-charts/                                                          0.12.8
onprem/fleet-rs-secret                   https://kubernetes.default.svc  fleet-default         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/haproxy-ingress-pxe-boots         https://kubernetes.default.svc  orch-boots            onprem   Synced  Progressing  Auto-Prune  <none>      https://github.com/open-edge-platform/orch-utils.git                charts/haproxy-ingress-pxe-boots  haproxy_changes_nginx_naming
onprem/harbor-oci                        https://kubernetes.default.svc  orch-harbor           onprem   Synced  Healthy      Auto-Prune  <none>      https://helm.goharbor.io                                                                              1.17.2
onprem/infra-core                        https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     2.18.3
onprem/infra-external                    https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     2.12.2
onprem/infra-managers                    https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     2.16.8
onprem/infra-onboarding                  https://kubernetes.default.svc  orch-infra            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.34.0
onprem/ingress-haproxy                   https://kubernetes.default.svc  orch-boots            onprem   Synced  Healthy      Auto-Prune  <none>      https://haproxytech.github.io/helm-charts                                                             1.41.0
onprem/intel-infra-provider              https://kubernetes.default.svc  orch-cluster          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.3.4
onprem/istio-base                        https://kubernetes.default.svc  istio-system          onprem   Synced  Healthy      Auto-Prune  <none>      https://istio-release.storage.googleapis.com/charts                                                   1.28.0
onprem/istio-policy                      https://kubernetes.default.svc  istio-system          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     2.0.7
onprem/istiod                            https://kubernetes.default.svc  istio-system          onprem   Synced  Healthy      Auto-Prune  <none>      https://istio-release.storage.googleapis.com/charts                                                   1.28.0
onprem/keycloak-operator                 https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.1.1
onprem/keycloak-tenant-controller        https://kubernetes.default.svc  orch-gateway          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.0.1
onprem/kiali                             https://kubernetes.default.svc  istio-system          onprem   Synced  Healthy      Auto-Prune  <none>      https://kiali.org/helm-charts                                                                         2.18.0
onprem/kyverno                           https://kubernetes.default.svc  kyverno               onprem   Synced  Healthy      Auto-Prune  <none>      https://kyverno.github.io/kyverno                                                                     3.6.1
onprem/kyverno-extra-policies            https://kubernetes.default.svc  kyverno               onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     3.0.3
onprem/kyverno-istio-policy              https://kubernetes.default.svc  kyverno               onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.0.1
onprem/kyverno-traefik-policy            https://kubernetes.default.svc  kyverno               onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.1
onprem/metadata-broker                   https://kubernetes.default.svc  orch-ui               onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.0.0
onprem/metallb                           https://kubernetes.default.svc  metallb-system        onprem   Synced  Healthy      Auto-Prune  <none>      https://metallb.github.io/metallb                                                                     0.15.2
onprem/metallb-config                    https://kubernetes.default.svc  metallb-system        onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.0.1
onprem/namespace-label                   https://kubernetes.default.svc  ns-label              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.3
onprem/nexus-api-gw                      https://kubernetes.default.svc  orch-iam              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.0.1
onprem/observability-tenant-controller   https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     0.7.0
onprem/orchestrator-dashboards           https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     0.3.2
onprem/orchestrator-observability        https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     0.5.15
onprem/orchestrator-prometheus-agent     https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      https://prometheus-community.github.io/helm-charts                                                    79.7.1
onprem/platform-autocert                 https://kubernetes.default.svc  cert-manager          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     1.0.2
onprem/platform-keycloak                 https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.1.1
onprem/postgresql-cluster                https://kubernetes.default.svc  orch-database         onprem   Synced  Healthy      Auto-Prune  <none>      ghcr.io/cloudnative-pg/charts                                                                         0.3.1
onprem/postgresql-operator               https://kubernetes.default.svc  postgresql-operator   onprem   Synced  Healthy      Auto-Prune  <none>      ghcr.io/cloudnative-pg/charts                                                                         0.26.0
onprem/postgresql-secrets                https://kubernetes.default.svc  orch-database         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.0.1
onprem/prometheus-crd                    https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      https://prometheus-community.github.io/helm-charts                                                    24.0.1
onprem/reloader                          https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      https://stakater.github.io/stakater-charts                                                            2.2.3
onprem/root-app                          https://kubernetes.default.svc  onprem                onprem   Synced  Progressing  Auto-Prune  <none>      https://github.com/open-edge-platform/edge-manageability-framework  argocd/applications               606cb7462c460165a1cefbec339e8cf213329104
onprem/rs-proxy                          https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.3
onprem/secret-wait-tls-boots             https://kubernetes.default.svc  orch-boots            onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.3
onprem/secret-wait-tls-orch              https://kubernetes.default.svc  orch-gateway          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.3
onprem/secrets-config                    https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     3.0.6
onprem/self-signed-cert                  https://kubernetes.default.svc  cert-manager          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     4.0.11
onprem/sre-exporter                      https://kubernetes.default.svc  orch-sre              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     0.9.2
onprem/tenancy-api-mapping               https://kubernetes.default.svc  orch-iam              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.0.1
onprem/tenancy-datamodel                 https://kubernetes.default.svc  orch-iam              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.2
onprem/tenancy-manager                   https://kubernetes.default.svc  orch-iam              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.0.1
onprem/token-fs                          https://kubernetes.default.svc  orch-secret           onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.0.1
onprem/traefik                           https://kubernetes.default.svc  orch-gateway          onprem   Synced  Healthy      Auto-Prune  <none>      https://helm.traefik.io/traefik                                                                       37.2.0
onprem/traefik-extra-objects             https://kubernetes.default.svc  orch-gateway          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     26.0.1
onprem/traefik-pre                       https://kubernetes.default.svc  orch-gateway          onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     3.0.1
onprem/vault                             https://kubernetes.default.svc  orch-platform         onprem   Synced  Healthy      Auto-Prune  <none>      https://helm.releases.hashicorp.com                                                                   0.31.0
onprem/wait-istio-job                    https://kubernetes.default.svc  ns-label              onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     25.2.3
onprem/web-ui-admin                      https://kubernetes.default.svc  orch-ui               onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     3.2.4
onprem/web-ui-app-orch                   https://kubernetes.default.svc  orch-ui               onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     4.0.2
onprem/web-ui-cluster-orch               https://kubernetes.default.svc  orch-ui               onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     4.0.0
onprem/web-ui-infra                      https://kubernetes.default.svc  orch-ui               onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     3.2.17
onprem/web-ui-root                       https://kubernetes.default.svc  orch-ui               onprem   Synced  Healthy      Auto-Prune  <none>      registry-rs.edgeorchestration.intel.com/edge-orch                                                     4.0.1
=== END Argo CD Application List ===
=== BEGIN onprem/haproxy-ingress-pxe-boots Manifests ===
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    argocd.argoproj.io/tracking-id: onprem_haproxy-ingress-pxe-boots:/Service:orch-boots/ingress-nginx-controller
    metallb.universe.tf/address-pool: example
  labels:
    app.kubernetes.io/component: alias
    app.kubernetes.io/instance: ingress-nginx-controller
    app.kubernetes.io/name: kubernetes-ingress
  name: ingress-nginx-controller
  namespace: orch-boots
spec:
  ipFamilies:
  - IPv4
  ipFamilyPolicy: SingleStack
  ports:
  - appProtocol: https
    name: https
    port: 443
    protocol: TCP
    targetPort: https
  - appProtocol: https
    name: quic
    port: 443
    protocol: UDP
    targetPort: quic
  selector:
    app.kubernetes.io/instance: ingress-nginx-controller
    app.kubernetes.io/name: kubernetes-ingress
  type: LoadBalancer

---
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  annotations:
    argocd.argoproj.io/tracking-id: onprem_haproxy-ingress-pxe-boots:cert-manager.io/Certificate:orch-boots/tls-boots
  name: tls-boots
  namespace: orch-boots
spec:
  commonName: tinkerbell-nginx.cluster.onprem
  dnsNames:
  - tinkerbell-nginx.cluster.onprem
  duration: 8765h0m0s
  isCA: true
  issuerRef:
    kind: Issuer
    name: boots-selfsigned-issuer
  privateKey:
    algorithm: RSA
    encoding: PKCS1
    size: 3072
  renewBefore: 2160h0m0s
  secretName: tls-boots
  subject:
    countries:
    - US
    organizations:
    - Intel Corporation
  usages:
  - digital signature
  - server auth

---
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  annotations:
    argocd.argoproj.io/tracking-id: onprem_haproxy-ingress-pxe-boots:cert-manager.io/Certificate:orch-infra/tls-boots
  name: tls-boots
  namespace: orch-infra
spec:
  commonName: tinkerbell-nginx.cluster.onprem
  dnsNames:
  - tinkerbell-nginx.cluster.onprem
  duration: 8765h0m0s
  isCA: true
  issuerRef:
    kind: Issuer
    name: boots-selfsigned-issuer
  privateKey:
    algorithm: RSA
    encoding: PKCS1
    size: 3072
  renewBefore: 2160h0m0s
  secretName: tls-boots
  subject:
    countries:
    - US
    organizations:
    - Intel Corporation
  usages:
  - digital signature
  - server auth

---
apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  annotations:
    argocd.argoproj.io/tracking-id: onprem_haproxy-ingress-pxe-boots:cert-manager.io/Issuer:orch-boots/boots-selfsigned-issuer
  name: boots-selfsigned-issuer
  namespace: orch-boots
spec:
  selfSigned: {}

---
apiVersion: cert-manager.io/v1
kind: Issuer
metadata:
  annotations:
    argocd.argoproj.io/tracking-id: onprem_haproxy-ingress-pxe-boots:cert-manager.io/Issuer:orch-infra/boots-selfsigned-issuer
  name: boots-selfsigned-issuer
  namespace: orch-infra
spec:
  selfSigned: {}

---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    argocd.argoproj.io/tracking-id: onprem_haproxy-ingress-pxe-boots:networking.k8s.io/Ingress:orch-infra/tinkerbell-nginx-ingress
    haproxy.org/path-rewrite: /tink-stack/(.*) /\1
    haproxy.org/rate-limit: "true"
    haproxy.org/rate-limit-period: 1s
    haproxy.org/rate-limit-requests: "500"
  name: tinkerbell-nginx-ingress
  namespace: orch-infra
spec:
  ingressClassName: haproxy
  rules:
  - host: tinkerbell-nginx.cluster.onprem
    http:
      paths:
      - backend:
          service:
            name: tinkerbell
            port:
              number: 8080
        path: /tink-stack
        pathType: Prefix
  tls:
  - hosts:
    - tinkerbell-nginx.cluster.onprem
    secretName: tls-boots

---
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  annotations:
    argocd.argoproj.io/tracking-id: onprem_haproxy-ingress-pxe-boots:security.istio.io/PeerAuthentication:orch-infra/tinkerbell-permissive
  name: tinkerbell-permissive
  namespace: orch-infra
spec:
  mtls:
    mode: PERMISSIVE
  selector:
    matchLabels:
      app: tink-stack

=== END onprem/haproxy-ingress-pxe-boots Manifests ===
=== BEGIN onprem/haproxy-ingress-pxe-boots Diff ===
=== END onprem/haproxy-ingress-pxe-boots Diff ===
=== BEGIN onprem/root-app Manifests ===
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1900"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/alerting-monitor
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: alerting-monitor
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: ""
    jsonPointers:
    - /data
    - /metadata
    kind: Secret
  project: onprem
  sources:
  - chart: o11y/charts/alerting-monitor
    helm:
      releaseName: alerting-monitor
      valuesObject:
        alertmanager:
          configmapReload:
            image:
              tag: v0.86.2
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        authentication:
          oidcServer: https://keycloak.cluster.onprem:443
          oidcServerRealm: master
        caSecretKey: ca.crt
        caSecretName: gateway-ca-cert
        database:
          databaseSecret: alerting-local-postgresql
          ssl: false
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
        imagePullSecrets: null
        initialRules:
          hostAggregationWindowSeconds: 240
        istio-proxy:
          securityContext:
            readOnlyRootFilesystem: true
        management:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
        multitenantGatewayEnabled: true
        observabilityUIAddress: https://observability-ui.cluster.onprem
        openPolicyAgent:
          config:
            profile: compressed
          image:
            tag: 1.10.1-static
        smtp:
          configSecret: smtp
          initialize: true
          insecureSkipVerify: false
          passwordSecret:
            key: password
            name: smtp-auth
          requireTls: true
          userPasswordAuth: true
        traefik:
          matchRoute: Host(`alerting-monitor.cluster.onprem`)
          tlsOption: gateway-tls
        traefikApiGroup: traefik.io/v1alpha1
        webUIAddress: https://web-ui.cluster.onprem
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.7.4
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/app-deployment-crd
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: app-deployment-crd
  namespace: onprem
spec:
  destination:
    namespace: orch-app
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: app/charts/app-deployment-crd
    helm:
      releaseName: app-deployment-crd
      valuesObject: {}
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 2.6.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/app-deployment-manager
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: app-deployment-manager
  namespace: onprem
spec:
  destination:
    namespace: orch-app
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: app/charts/app-deployment-manager
    helm:
      releaseName: app-deployment-manager
      valuesObject:
        adm:
          apiExtension:
            apiAgent:
              helmSecretName: intel-reg-secret
              namespace: orch-app
            apiProxy:
              namespace: orch-app
              url: wss://ws-app-service-proxy.cluster.onprem
          capi:
            enabled: true
          catalogService: app-orch-catalog-grpc-server:8080
          fleet:
            pollingInterval: 30
          fleetGitClientSecretName: app-gitea-credential
          fleetGitRemoteType: http
          fullnameOverride: app-deployment-manager
          gitProxy: null
          gitServer: https://gitea-http.gitea.svc.cluster.local
          gitUseCaCert: true
          keycloakServerEndpoint: http://platform-keycloak.orch-platform.svc.cluster.local:8080
          releaseServiceProxy:
            remoteNamespace: orch-platform
            repo: oci://rs-proxy.orch-platform.svc.cluster.local:8443
            repoSecret: fleet-rs-secret
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          secretService:
            enabled: true
            endpoint: http://vault.orch-platform.svc.cluster.local:8200
          serviceAccount:
            create: false
            name: orch-svc
        controller:
          securityContext:
            readOnlyRootFilesystem: true
        gateway:
          deployment:
            namespace: fleet-default
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        gitea:
          install: false
        global:
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        image:
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        istio-proxy:
          securityContext:
            readOnlyRootFilesystem: true
        mockCompositeApps: []
        openidc:
          insecureSkipVerify: false
          issuer: http://platform-keycloak.orch-platform.svc/realms/master
        openpolicyagent:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        traefikReverseProxy:
          enabled: true
          gatewayNamespace: orch-gateway
          matchRoute: Host(`app-orch.cluster.onprem`)
          secretName: tls-orch
          tlsOption: gateway-tls
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 2.6.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/app-deployment-manager-secret
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: app-deployment-manager-secret
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/adm-secret
    helm:
      releaseName: app-deployment-manager-secret
      valuesObject: {}
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1101"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/app-orch-catalog
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: app-orch-catalog
  namespace: onprem
spec:
  destination:
    namespace: orch-app
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: app/charts/app-orch-catalog
    helm:
      releaseName: app-orch-catalog
      valuesObject:
        application-catalog-rest-proxy:
          securityContext:
            readOnlyRootFilesystem: true
        application-catalog-server:
          securityContext:
            readOnlyRootFilesystem: true
        catalogServer: null
        fullnameOverride: app-orch-catalog
        global:
          registry:
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        healthcheck:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
        image:
          pullPolicy: IfNotPresent
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
        imagePullSecrets: null
        ingress:
          enabled: false
        istio-proxy:
          securityContext:
            readOnlyRootFilesystem: true
        openidc:
          external: https://keycloak.cluster.onprem/realms/master
          issuer: http://platform-keycloak.orch-platform.svc/realms/master
        openpolicyagent:
          securityContext:
            readOnlyRootFilesystem: true
        postgres:
          enabled: false
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
          secrets: app-orch-catalog-local-postgresql
          ssl: false
        resources: null
        service:
          restProxy:
            port: 8081
        serviceAccount: orch-svc
        storage:
          size: 5Gi
        storageClassName: openebs-hostpath
        traefikReverseProxy:
          enabled: true
          matchRoute: Host(`app-orch.cluster.onprem`)
          secretName: tls-orch
          tlsOption: gateway-tls
        useSecretsService: true
        vaultServerAddress: http://vault.orch-platform.svc.cluster.local:8200
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 0.16.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/app-orch-tenant-controller
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: app-orch-tenant-controller
  namespace: onprem
spec:
  destination:
    namespace: orch-app
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: app/charts/app-orch-tenant-controller
    helm:
      releaseName: app-orch-tenant-controller
      valuesObject:
        clusterDomain: cluster.onprem
        configProvisioner:
          admServer: app-deployment-api-grpc-server.orch-app.svc.cluster.local:8080
          catalogServer: app-orch-catalog-grpc-server.orch-app.svc.cluster.local:8080
          harborServerExternal: https://registry-oci.cluster.onprem
          keycloakServer: https://keycloak.cluster.onprem
          keycloakServiceBase: http://platform-keycloak.orch-platform.svc.cluster.local:8080
          manifestPath: /edge-orch/en/file/cluster-extension-manifest
          manifestTag: v1.5.2
          namespace: orch-app
          releaseServiceBase: rs-proxy.orch-platform.svc.cluster.local:8081
          releaseServiceProxyRootUrl: oci://rs-proxy.orch-platform.svc.cluster.local:8443
          releaseServiceRootUrl: oci://registry-rs.edgeorchestration.intel.com
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          serviceAccount: orch-svc
          useM2MToken: true
          vaultServer: http://vault.orch-platform.svc.cluster.local:8200
        global:
          registry:
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        image:
          registry:
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        resources: null
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 0.5.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/app-resource-manager
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: app-resource-manager
  namespace: onprem
spec:
  destination:
    namespace: orch-app
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: app/charts/app-resource-manager
    helm:
      releaseName: app-resource-manager
      valuesObject:
        config:
          serviceProxy:
            domainName: https://app-service-proxy.cluster.onprem
          webSocketServer:
            allowedOrigins:
            - https://cluster.onprem
            - https://vnc.cluster.onprem
            hostName: vnc.cluster.onprem
        defaultNamespace: orch-app
        fullnameOverride: app-resource-manager
        image:
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        keycloakServer: http://platform-keycloak.orch-platform.svc.cluster.local:8080
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        restProxy:
          image:
            registry:
              imagePullSecrets: null
              name: registry-rs.edgeorchestration.intel.com/edge-orch
        serviceAccount:
          create: false
          name: orch-svc
        traefikApiGroup: traefik.io/v1alpha1
        traefikReverseProxy:
          gatewayNamespace: orch-gateway
          restProxy:
            enabled: true
            matchRoute: Host(`app-orch.cluster.onprem`)
          secretName: tls-orch
          tlsOption: gateway-tls
        vaultServer: http://vault.orch-platform.svc.cluster.local:8200
        vncProxy:
          image:
            registry:
              imagePullSecrets: null
              name: registry-rs.edgeorchestration.intel.com/edge-orch
        vncProxyResources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 2.6.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/app-service-proxy
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: app-service-proxy
  namespace: onprem
spec:
  destination:
    namespace: orch-app
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: app/charts/app-service-proxy
    helm:
      releaseName: app-service-proxy
      valuesObject:
        agent:
          config:
            proxyDomain: app-service-proxy.cluster.onprem
            proxyServerURL: wss://app-orch.cluster.onprem/app-service-proxy
          image:
            registry:
              name: localhost.internal:9443
        fullnameOverride: app-service-proxy
        git:
          clientSecret: app-gitea-credential
          gitUseCaCert: true
          proxy: null
          remoteType: http
          server: https://gitea-http.gitea.svc.cluster.local
        image:
          pullPolicy: IfNotPresent
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        serviceAccount:
          create: false
          name: orch-svc
        traefik:
          enabled: true
          gatewayNamespace: orch-gateway
          matchRoute: Host(`app-service-proxy.cluster.onprem`)
          matchRouteSrc: Host(`app-service-proxy.cluster.onprem`) && PathPrefix(`/app-service-proxy`)
          secretName: tls-orch
          tlsOption: gateway-tls
        traefikApiGroup: traefik.io/v1alpha1
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.6.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2005"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/auth-service
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: auth-service
  namespace: onprem
spec:
  destination:
    namespace: orch-gateway
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/auth-service
    helm:
      releaseName: auth-service
      valuesObject:
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
          repository: common/auth-service
        imagePullSecrets: null
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/capi-operator
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: capi-operator
  namespace: onprem
spec:
  destination:
    namespace: capi-operator-system
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: cluster-api-operator
    helm:
      releaseName: capi-operator
      valuesObject:
        containerSecurityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        diagnosticsAddress: :8080
        env:
          manager: null
        insecureDiagnostics: true
        resources:
          manager:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
    repoURL: https://kubernetes-sigs.github.io/cluster-api-operator
    targetRevision: 0.23.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 10s
        factor: 2
        maxDuration: 3m0s
      limit: 15
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "990"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/capi-operator-pre
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: capi-operator-pre
  namespace: onprem
spec:
  destination:
    namespace: capi-variables
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/capi-operator-pre
    helm:
      releaseName: capi-operator-pre
      valuesObject: {}
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/capi-providers-config
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: capi-providers-config
  namespace: onprem
spec:
  destination:
    namespace: capi-operator-system
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/capi-providers-config
    helm:
      releaseName: capi-providers-config
      valuesObject:
        bootstrap:
          providers:
          - name: k3s
            namespace: capk-system
            spec:
              additionalManifests:
                name: bootstrap-k3s-additional-manifest
                namespace: capk-system
              configSecret:
                name: capi-variables
                namespace: capi-variables
              fetchConfig:
                url: https://github.com/k3s-io/cluster-api-k3s/releases/v0.3.0/bootstrap-components.yaml
              version: v0.3.0
        controlplane:
          providers:
          - name: k3s
            namespace: capk-system
            spec:
              additionalManifests:
                name: controlplane-k3s-additional-manifest
                namespace: capk-system
              configSecret:
                name: capi-variables
                namespace: capi-variables
              fetchConfig:
                url: https://github.com/k3s-io/cluster-api-k3s/releases/v0.3.0/control-plane-components.yaml
              version: v0.3.0
        core:
          name: cluster-api
          namespace: capi-system
          spec:
            additionalManifests:
              name: core-additional-manifest
              namespace: capi-system
            configSecret:
              name: capi-variables
              namespace: capi-variables
            deployment:
              containers:
              - args:
                  --additional-sync-machine-labels: .*
                  --cluster-concurrency: "10"
                  --clustercache-client-burst: "150"
                  --clustercache-client-qps: "100"
                  --insecure-diagnostics: "true"
                  --kube-api-burst: "150"
                  --kube-api-qps: "100"
                  --machine-concurrency: "10"
                name: manager
            manager:
              featureGates:
                ClusterResourceSet: true
                ClusterTopology: true
                MachinePool: true
                MachineSetPreflightChecks: true
                MachineWaitForVolumeDetachConsiderVolumeAttachments: true
                RuntimeSDK: false
            version: v1.10.7
        metrics:
          enabled: true
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/cert-manager
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: cert-manager
  namespace: onprem
spec:
  destination:
    namespace: cert-manager
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: cert-manager
    helm:
      releaseName: cert-manager
      valuesObject:
        cainjector:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        installCRDs: true
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        webhook:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
    repoURL: https://charts.jetstack.io
    targetRevision: 1.17.4
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "3000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/certificate-file-server
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: certificate-file-server
  namespace: onprem
spec:
  destination:
    namespace: orch-gateway
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/certificate-file-server
    helm:
      releaseName: certificate-file-server
      valuesObject:
        orchSecretName: tls-orch
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        rootMatchHost: Host(`cluster.onprem`)
        tlsOption: gateway-tls
        traefikApiGroup: traefik.io/v1alpha1
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/cluster-connect-gateway
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: cluster-connect-gateway
  namespace: onprem
spec:
  destination:
    namespace: orch-cluster
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: cluster/charts/cluster-connect-gateway
    helm:
      releaseName: cluster-connect-gateway
      valuesObject:
        agent:
          tlsMode: system-store
        controller:
          metrics:
            serviceMonitor:
              enabled: true
          privateCA:
            enabled: true
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        fullnameOverride: cluster-connect-gateway
        gateway:
          externalUrl: wss://connect-gateway.cluster.onprem:443
          ingress:
            enabled: true
            hostname: connect-gateway.cluster.onprem
            namespace: orch-gateway
          metrics:
            serviceMonitor:
              enabled: true
          oidc:
            enabled: true
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        openpolicyagent:
          enabled: true
          tag: 1.10.1-static
        security:
          agent:
            authMode: jwt
        traefikApiGroup: traefik.io/v1alpha1
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.2.5
  - chart: cluster/charts/cluster-connect-gateway-crd
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.2.5
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/cluster-manager
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: cluster-manager
  namespace: onprem
spec:
  destination:
    namespace: orch-cluster
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: cluster/charts/cluster-manager
    helm:
      releaseName: cluster-manager
      valuesObject:
        clusterManager:
          args:
            clusterdomain: cluster.onprem
            kubeconfig-ttl-hours: 3
          extraArgs:
            disable-metrics: false
          image:
            registry:
              imagePullSecrets: null
              name: registry-rs.edgeorchestration.intel.com/edge-orch
            repository: cluster/cluster-manager
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        credentialsM2M:
          enabled: true
          job:
            activeDeadlineSeconds: 1200
            backoffLimit: 15
            resources:
              limits:
                cpu: "2"
                memory: 2Gi
              requests:
                cpu: 10m
                memory: 16Mi
            retryAttempts: 10
            retryDelay: 30
            terminationGracePeriodSeconds: 90
            ttlSecondsAfterFinished: 14400
          keycloak:
            adminSecretName: platform-keycloak
            adminSecretNamespace: orch-platform
            clientId: co-manager-m2m-client
            port: 8080
            realm: master
            service: platform-keycloak.orch-platform.svc.cluster.local
          vault:
            authPath: auth/kubernetes
            port: 8200
            secretPath: secret/data/co-manager-m2m-client-secret
            service: vault.orch-platform.svc.cluster.local
        curlImage:
          name: badouralix/curl-jq@sha256
          pullPolicy: IfNotPresent
          tag: 8ee002ae4452b23a3c70750c5c081e95334cfe9f7968fb4d67a90d4001c29d0b
        metrics:
          enabled: true
        openpolicyagent:
          tag: 1.10.1-static
        templateController:
          image:
            registry:
              imagePullSecrets: null
              name: registry-rs.edgeorchestration.intel.com/edge-orch
            repository: cluster/template-controller
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 2.2.6
  - chart: cluster/charts/cluster-template-crd
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 2.2.6
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/component-status
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: component-status
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/component-status
    helm:
      releaseName: component-status
      valuesObject:
        componentStatus:
          orchestrator:
            features:
              application-orchestration:
                installed: true
              cluster-orchestration:
                capi:
                  installed: true
                cluster-management:
                  installed: true
                installed: true
                intel-provider:
                  installed: true
              edge-infrastructure-manager:
                day2:
                  installed: true
                installed: true
                onboarding:
                  installed: true
                oob:
                  installed: true
                provisioning:
                  installed: true
              edgenode-observability:
                dashboards:
                  installed: true
                installed: true
                monitoring:
                  installed: true
              kyverno:
                installed: true
                policies:
                  installed: true
                policy-engine:
                  installed: true
              multitenancy:
                default-tenant-only:
                  installed: false
                installed: true
              orchestrator-observability:
                alerting:
                  installed: true
                dashboards:
                  installed: true
                installed: true
                monitoring:
                  installed: true
              web-ui:
                application-orchestration-ui:
                  installed: true
                cluster-orchestration-ui:
                  installed: true
                infrastructure-ui:
                  installed: true
                installed: true
                orchestrator-ui-root:
                  installed: true
            version: 2026.0.0-dev
          schema-version: "1.0"
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
          repository: common/component-status
        imagePullSecrets: null
        resources: null
        traefikRoute:
          enabled: true
          matchHost: Host(`api.cluster.onprem`)
          matchPath: PathPrefix(`/v1/orchestrator`)
          middlewares:
          - validate-jwt
          - secure-headers
          namespace: orch-gateway
          priority: 40
          secretName: tls-orch
          tlsOption: gateway-tls
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.0.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1200"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/copy-app-gitea-cred-to-fleet
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: copy-app-gitea-cred-to-fleet
  namespace: onprem
spec:
  destination:
    namespace: fleet-default
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/copy-secret
    helm:
      releaseName: copy-app-gitea-cred-to-fleet
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        keyName:
        - source: username
          target: username
        - source: password
          target: password
        refreshInterval: 10m
        remoteNamespace: orch-platform
        sourceSecretName: app-gitea-credential
        targetSecretName: app-gitea-credential
        type: kubernetes.io/basic-auth
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1400"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/copy-ca-cert-boots-to-gateway
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: copy-ca-cert-boots-to-gateway
  namespace: onprem
spec:
  destination:
    namespace: orch-gateway
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/copy-secret
    helm:
      releaseName: copy-ca-cert-boots-to-gateway
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        keyName:
        - source: tls.crt
          target: ca.crt
        refreshInterval: 10m
        remoteNamespace: orch-boots
        sourceSecretName: tls-boots
        targetSecretName: boots-ca-cert
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1400"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/copy-ca-cert-boots-to-infra
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: copy-ca-cert-boots-to-infra
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/copy-secret
    helm:
      releaseName: copy-ca-cert-boots-to-infra
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        keyName:
        - source: tls.crt
          target: ca.crt
        refreshInterval: 10m
        remoteNamespace: orch-boots
        sourceSecretName: tls-boots
        targetSecretName: boots-ca-cert
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "180"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/copy-ca-cert-gateway-to-cattle
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: copy-ca-cert-gateway-to-cattle
  namespace: onprem
spec:
  destination:
    namespace: cattle-system
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/copy-secret
    helm:
      releaseName: copy-ca-cert-gateway-to-cattle
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        keyName:
        - source: ca.crt
          target: cacerts.pem
        refreshInterval: 10m
        remoteNamespace: orch-gateway
        sourceSecretName: tls-orch
        targetSecretName: tls-ca
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "180"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/copy-ca-cert-gateway-to-infra
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: copy-ca-cert-gateway-to-infra
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/copy-secret
    helm:
      releaseName: copy-ca-cert-gateway-to-infra
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        keyName:
        - source: ca.crt
          target: ca.crt
        refreshInterval: 10m
        remoteNamespace: orch-gateway
        sourceSecretName: tls-orch
        targetSecretName: gateway-ca-cert
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "180"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/copy-ca-cert-gitea-to-app
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: copy-ca-cert-gitea-to-app
  namespace: onprem
spec:
  destination:
    namespace: orch-app
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/copy-secret
    helm:
      releaseName: copy-ca-cert-gitea-to-app
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        keyName:
        - source: tls.crt
          target: ca.crt
        refreshInterval: 10m
        remoteNamespace: gitea
        sourceSecretName: gitea-tls-certs
        targetSecretName: gitea-ca-cert
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "180"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/copy-ca-cert-gitea-to-cluster
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: copy-ca-cert-gitea-to-cluster
  namespace: onprem
spec:
  destination:
    namespace: orch-cluster
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/copy-secret
    helm:
      releaseName: copy-ca-cert-gitea-to-cluster
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        keyName:
        - source: tls.crt
          target: ca.crt
        refreshInterval: 10m
        remoteNamespace: gitea
        sourceSecretName: gitea-tls-certs
        targetSecretName: gitea-ca-cert
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1200"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/copy-cluster-gitea-cred-to-fleet
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: copy-cluster-gitea-cred-to-fleet
  namespace: onprem
spec:
  destination:
    namespace: fleet-default
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/copy-secret
    helm:
      releaseName: copy-cluster-gitea-cred-to-fleet
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        keyName:
        - source: username
          target: username
        - source: password
          target: password
        refreshInterval: 10m
        remoteNamespace: orch-platform
        sourceSecretName: cluster-gitea-credential
        targetSecretName: cluster-gitea-credential
        type: kubernetes.io/basic-auth
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "180"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/copy-keycloak-admin-to-infra
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: copy-keycloak-admin-to-infra
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/copy-secret
    helm:
      releaseName: copy-keycloak-admin-to-infra
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        keyName:
        - source: admin-password
          target: admin-password
        - source: password
          target: password
        - source: username
          target: username
        refreshInterval: 0m
        remoteNamespace: orch-platform
        sourceSecretName: platform-keycloak
        targetSecretName: platform-keycloak
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/edgenode-dashboards
  name: edgenode-dashboards
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: o11y/charts/edgenode-dashboards
    helm:
      releaseName: edgenode-dashboards
      valuesObject: {}
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 0.3.9
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/edgenode-observability
  name: edgenode-observability
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: o11y/charts/edgenode-observability
    helm:
      releaseName: edgenode-observability
      valuesObject:
        grafana:
          grafana.ini:
            auth:
              signout_redirect_url: https://keycloak.cluster.onprem/realms/master/protocol/openid-connect/logout?redirect_uri=https%3A%2F%2Fweb-ui.cluster.onprem
            auth.generic_oauth:
              auth_url: https://keycloak.cluster.onprem/realms/master/protocol/openid-connect/auth
            server:
              root_url: https://observability-ui.cluster.onprem
          grafana_proxy:
            registry: registry-rs.edgeorchestration.intel.com/edge-orch
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          imagePullSecrets: null
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          sidecar:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        loki:
          backend:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          chunksCache:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          gateway:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          loki:
            commonConfig:
              replication_factor: 3
            compactor:
              retention_enabled: true
            limits_config:
              retention_period: 24h
              retention_stream:
              - period: 168h
                priority: 1
                selector: '{source="edgenode_provisioning"}'
            storage:
              s3:
                endpoint: edgenode-observability-minio:9000
          memcachedExporter:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          minio:
            image:
              tag: RELEASE.2025-09-07T16-13-09Z
            mcImage:
              tag: RELEASE.2025-08-13T08-35-41Z
          read:
            persistence:
              size: 8Gi
            replicas: 3
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          resultsCache:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          sidecar:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          write:
            persistence:
              size: 8Gi
            replicas: 3
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        mimir-distributed:
          compactor:
            persistentVolume:
              size: 15Gi
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          distributor:
            replicas: 1
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          gateway:
            ingress:
              enabled: false
            nginx:
              config:
                serverSnippet: |
                  client_header_buffer_size 64k;
                  large_client_header_buffers 64 128k;
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          ingester:
            persistentVolume:
              size: 12Gi
            replicas: 2
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          kafka:
            enabled: false
          mimir:
            structuredConfig:
              blocks_storage:
                backend: s3
                tsdb:
                  wal_compression_enabled: true
              distributor:
                remote_timeout: null
              ingest_storage:
                enabled: false
                kafka:
                  address: null
                  auto_create_topic_default_partitions: null
                  topic: null
              ingester:
                push_grpc_method_enabled: true
              limits:
                compactor_blocks_retention_period: 24h
              ruler_storage:
                backend: s3
          minio:
            deploymentUpdate:
              type: Recreate
            image:
              tag: RELEASE.2025-09-07T16-13-09Z
            makeBucketJob:
              exitCommand: ""
            makePolicyJob:
              exitCommand: ""
            makeUserJob:
              exitCommand: ""
            mcImage:
              tag: RELEASE.2025-08-13T08-35-41Z
            persistence:
              size: 15Gi
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          querier:
            replicas: 3
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          query_frontend:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          query_scheduler:
            enabled: true
          ruler:
            replicas: 2
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          store_gateway:
            persistentVolume:
              size: 5Gi
            replicas: 1
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        opentelemetry-collector:
          alternateConfig:
            receivers:
              otlp:
                protocols:
                  grpc:
                    endpoint: ${env:MY_POD_IP}:4317
                  http:
                    endpoint: ${env:MY_POD_IP}:4318
                    include_metadata: true
            service:
              pipelines:
                metrics:
                  receivers:
                  - otlp
                  - prometheus/infra-exporter
                  - prometheus/adm-status
                  - prometheus/observability-tenant-controller
              telemetry:
                metrics:
                  level: detailed
                  readers:
                  - pull:
                      exporter:
                        prometheus:
                          host: ${env:MY_POD_IP}
                          port: 8888
                          without_type_suffix: true
                          without_units: true
          image:
            repository: registry-rs.edgeorchestration.intel.com/edge-orch/o11y/orch-otelcol
          imagePullSecrets: null
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 0.10.18
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/external-secrets
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: external-secrets
  namespace: onprem
spec:
  destination:
    namespace: orch-secret
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: external-secrets
    helm:
      releaseName: external-secrets
      valuesObject:
        certController:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        extraEnv:
        - name: http_proxy
          value: null
        - name: https_proxy
          value: null
        - name: no_proxy
          value: null
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        webhook:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
    repoURL: https://charts.external-secrets.io
    targetRevision: 0.20.4
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - ServerSideApply=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1020"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/fleet-controller
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: fleet-controller
  namespace: onprem
spec:
  destination:
    namespace: cattle-fleet-system
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: fleet
    helm:
      releaseName: fleet-controller
      valuesObject:
        agentTLSMode: strict
        apiServerURL: https://fleet.cluster.onprem
        controller:
          reconciler:
            workers:
              bundle: "50"
              bundledeployment: "50"
              gitrepo: "50"
    repoURL: https://rancher.github.io/fleet-helm-charts/
    targetRevision: 0.12.8
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1010"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/fleet-crd
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: fleet-crd
  namespace: onprem
spec:
  destination:
    namespace: cattle-fleet-system
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: fleet-crd
    helm:
      releaseName: fleet-crd
      valuesObject: {}
    repoURL: https://rancher.github.io/fleet-helm-charts/
    targetRevision: 0.12.8
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1200"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/fleet-rs-secret
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: fleet-rs-secret
  namespace: onprem
spec:
  destination:
    namespace: fleet-default
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/fleet-rs-secret
    helm:
      releaseName: fleet-rs-secret
      valuesObject:
        externalSecretsApiGroup: external-secrets.io/v1
        matchClusterLabels:
          app.edge-orchestrator.intel.com/fleet-rs-secret: "true"
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1200"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/haproxy-ingress-pxe-boots
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: haproxy-ingress-pxe-boots
  namespace: onprem
spec:
  destination:
    namespace: orch-boots
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: cert-manager.io
    jsonPointers:
    - /spec/isCA
    kind: Certificate
  project: onprem
  sources:
  - helm:
      releaseName: haproxy-ingress-pxe-boots
      valuesObject:
        commonName: tinkerbell-nginx.cluster.onprem
        haproxyIngress:
          enabled: true
        haproxyIngressRateLimit:
          connections: 70
          rps: 500
    path: charts/haproxy-ingress-pxe-boots
    repoURL: https://github.com/open-edge-platform/orch-utils.git
    targetRevision: haproxy_changes_nginx_naming
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - Replace=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/harbor-oci
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: harbor-oci
  namespace: onprem
spec:
  destination:
    namespace: orch-harbor
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - jsonPointers:
    - /data
    kind: Secret
    name: harbor-admin-password
    namespace: orch-harbor
  - jsonPointers:
    - /data
    kind: Secret
    name: harbor-admin-credential
    namespace: orch-harbor
  - jsonPointers:
    - /data
    kind: Secret
    name: harbor-oci-database
    namespace: orch-harbor
  - jsonPointers:
    - /data
    kind: Secret
    name: harbor-oci-trivy
    namespace: orch-harbor
  - jsonPointers:
    - /data
    kind: Secret
    name: harbor-oci-registryctl
    namespace: orch-harbor
  - group: ""
    jsonPointers:
    - /data
    kind: Secret
    name: harbor-oci-registry
    namespace: orch-harbor
  - group: ""
    jsonPointers:
    - /data
    kind: Secret
    name: harbor-oci-registry-htpasswd
    namespace: orch-harbor
  - group: ""
    jsonPointers:
    - /data
    kind: Secret
    name: harbor-oci-core
    namespace: orch-harbor
  - group: ""
    jsonPointers:
    - /data
    kind: Secret
    name: harbor-oci-jobservice
    namespace: orch-harbor
  - group: apps
    jsonPointers:
    - /spec/template/metadata/annotations
    kind: Deployment
    name: harbor-oci-jobservice
    namespace: orch-harbor
  - group: apps
    jsonPointers:
    - /spec/template/metadata/annotations
    kind: Deployment
    name: harbor-oci-core
    namespace: orch-harbor
  - group: apps
    jsonPointers:
    - /spec/template/metadata/annotations
    kind: Deployment
    name: harbor-oci-registry
    namespace: orch-harbor
  project: onprem
  sources:
  - chart: harbor
    helm:
      releaseName: harbor-oci
      valuesObject:
        core:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        database:
          internal:
            initContainer:
              migrator:
                resources:
                  limits:
                    cpu: "64"
                    memory: 64Gi
                  requests:
                    cpu: 1m
                    memory: 1Mi
              permissions:
                resources: null
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        existingSecretAdminPassword: harbor-admin-password
        existingSecretAdminPasswordKey: HARBOR_ADMIN_PASSWORD
        exporter:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        expose:
          tls:
            certSource: none
            enabled: false
          type: clusterIP
        externalURL: https://registry-oci.cluster.onprem
        jobservice:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        nginx:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        notary:
          enabled: false
        persistence:
          persistentVolumeClaim:
            database:
              storageClass: openebs-hostpath
            jobservice:
              jobLog:
                size: 1Gi
            registry:
              size: 100Gi
        portal:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        proxy:
          httpProxy: ""
          httpsProxy: ""
          noProxy: ""
        redis:
          internal:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        registry:
          controller:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          registry:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        tlsCoreSecretForIngress: harbor-ingress
        trivy:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        updateStrategy:
          type: Recreate
    repoURL: https://helm.goharbor.io
    targetRevision: 1.17.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 10s
        factor: 2
        maxDuration: 3m0s
      limit: 15
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/infra-core
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: infra-core
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: infra/charts/infra-core
    helm:
      releaseName: infra-core
      valuesObject:
        api:
          image:
            pullPolicy: IfNotPresent
          metrics:
            enabled: false
          multiTenancy:
            enforceMultiTenancy: "true"
          oidc:
            name: keycloak-api
            oidc_env_name: OIDC_SERVER_URL
            oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
            oidc_tls_insecure_skip_verify_env_name: OIDC_TLS_INSECURE_SKIP_VERIFY
            oidc_tls_insecure_skip_verify_value: "true"
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
          serviceArgs:
            enableAuth: true
            enableTracing: false
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          traefikApiGroup: traefik.io/v1alpha1
          traefikReverseProxy:
            enabled: false
        apiv2:
          image:
            pullPolicy: IfNotPresent
          metrics:
            enabled: false
          oidc:
            name: keycloak-api
            oidc_env_name: OIDC_SERVER_URL
            oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
            oidc_tls_insecure_skip_verify_env_name: OIDC_TLS_INSECURE_SKIP_VERIFY
            oidc_tls_insecure_skip_verify_value: "true"
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
          serviceArgsGrpc:
            enableAuth: true
            enableTracing: false
            globalLogLevel: debug
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          serviceArgsProxy:
            enableAuth: true
            enableTracing: false
            globalLogLevel: debug
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          traefikApiGroup: traefik.io/v1alpha1
          traefikReverseProxy:
            enabled: false
        credentials:
          curlImage:
            name: badouralix/curl-jq@sha256
            pullPolicy: IfNotPresent
            tag: 8ee002ae4452b23a3c70750c5c081e95334cfe9f7968fb4d67a90d4001c29d0b
          params:
            keycloakUrl: http://platform-keycloak.orch-platform.svc.cluster.local:8080
            vaultUrl: http://vault.orch-platform.svc.cluster.local:8200
          serviceAccount:
            name: orch-svc
        exporter:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
        global:
          registry:
            imagePullSecrets: []
            name: registry-rs.edgeorchestration.intel.com/edge-orch/
        import:
          exporter:
            enabled: true
          tenant-config:
            enabled: false
          tenant-controller:
            enabled: true
        inventory:
          image:
            pullPolicy: IfNotPresent
          inventory:
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          metrics:
            enabled: false
          miinv:
            enableTracing: false
          postgresql:
            pod:
              enabled: false
              image:
                tag: 16.10-bookworm
            readOnlyReplicasEnabled: false
            readOnlyReplicasSecrets: inventory-reader-local-postgresql
            secrets: inventory-local-postgresql
            ssl: false
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
          serviceAccount:
            name: orch-svc
        tenant-config:
          curlImage:
            name: badouralix/curl-jq@sha256
            pullPolicy: IfNotPresent
            tag: 8ee002ae4452b23a3c70750c5c081e95334cfe9f7968fb4d67a90d4001c29d0b
        tenant-controller:
          managerArgs:
            enableTracing: false
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          metrics:
            enabled: false
          oidc:
            oidc_server_url: http://platform-keycloak.orch-platform.svc.cluster.local/realms/master
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
          serviceAccount:
            name: orch-svc
          vault:
            role: orch-svc
            url: http://vault.orch-platform.svc.cluster.local:8200
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 2.18.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/infra-external
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: infra-external
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: infra/charts/infra-external
    helm:
      releaseName: infra-external
      valuesObject:
        amt:
          dm-manager:
            curlImage:
              name: badouralix/curl-jq@sha256
              pullPolicy: IfNotPresent
              tag: 8ee002ae4452b23a3c70750c5c081e95334cfe9f7968fb4d67a90d4001c29d0b
            env:
              oidc:
                oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
                oidc_tls_insecure_skip_verify_value: "true"
            params:
              password: ""
            serviceArgs:
              passwordPolicy: static
            tlsOption: gateway-tls
            traefikApiGroup: traefik.io/v1alpha1
            traefikReverseProxy:
              enabled: true
              gatewayNamespace: orch-gateway
              host:
                grpc:
                  name: device-manager-node.cluster.onprem
              secretName: tls-orch
              tlsOption: gateway-tls
          mps:
            commonName: mps.cluster.onprem
            curlImage:
              name: badouralix/curl-jq@sha256
              pullPolicy: IfNotPresent
              tag: 8ee002ae4452b23a3c70750c5c081e95334cfe9f7968fb4d67a90d4001c29d0b
            postgresql:
              image:
                tag: 16.10-bookworm
              ssl: "false"
              type: local
            tlsOption: gateway-tls
            traefikApiGroup: traefik.io/v1alpha1
            traefikReverseProxy:
              enabled: true
              gatewayNamespace: orch-gateway
              host:
                cira:
                  name: mps.cluster.onprem
                webport:
                  name: mps-wss.cluster.onprem
              secretName: tls-orch
              tlsOption: gateway-tls
          rps:
            postgresql:
              image:
                tag: 16.10-bookworm
              ssl: "false"
              type: local
            tlsOption: gateway-tls
            traefikApiGroup: traefik.io/v1alpha1
            traefikReverseProxy:
              enabled: true
              gatewayNamespace: orch-gateway
              host:
                grpc:
                  name: rps.cluster.onprem
                webport:
                  name: rps-wss.cluster.onprem
              secretName: tls-orch
              tlsOption: gateway-tls
        global:
          registry:
            imagePullSecrets: []
            name: registry-rs.edgeorchestration.intel.com/edge-orch/
        import:
          amt:
            enabled: true
          loca-credentials:
            enabled: false
          loca-manager:
            enabled: false
          loca-metadata-manager:
            enabled: false
          loca-templates-manager:
            enabled: false
        loca-credentials:
          curlImage:
            name: badouralix/curl-jq@sha256
            pullPolicy: IfNotPresent
            tag: 8ee002ae4452b23a3c70750c5c081e95334cfe9f7968fb4d67a90d4001c29d0b
          params:
            keycloakUrl: http://platform-keycloak.orch-platform.svc.cluster.local:8080
            vaultUrl: http://vault.orch-platform.svc.cluster.local:8200
          serviceAccount:
            name: orch-svc
        loca-manager:
          env:
            keycloakUrl: http://platform-keycloak.orch-platform.svc.cluster.local:8080
            vaultRole: orch-svc
            vaultUrl: http://vault.orch-platform.svc.cluster.local:8200
          multiTenancy:
            enforceMultiTenancy: true
          resources: null
          serviceAccount:
            name: orch-svc
          serviceArgs:
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
        loca-metadata-manager:
          env:
            vaultRole: orch-svc
            vaultUrl: http://vault.orch-platform.svc.cluster.local:8200
          multiTenancy:
            enforceMultiTenancy: true
          resources: null
          serviceAccount:
            name: orch-svc
          serviceArgs:
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
        loca-templates-manager:
          resources: null
          serviceAccount:
            name: orch-svc
          serviceArgs:
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          ubuntu_repos_certificates:
          - |
            -----BEGIN CERTIFICATE-----
            MIIE/zCCA+egAwIBAgISA1YYMk9tNlWtii3VhmtNbQp1MA0GCSqGSIb3DQEBCwUA
            MDMxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQwwCgYDVQQD
            EwNSMTAwHhcNMjUwMzExMjMyMDA2WhcNMjUwNjA5MjMyMDA1WjAiMSAwHgYDVQQD
            ExdvbGQtcmVsZWFzZXMudWJ1bnR1LmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEP
            ADCCAQoCggEBAL5bU9Q9Cf6KDe4+qaUhxzteYw9VpHHajyv3RtW1L44HYcrY23Fm
            Wl+B3NcKebgxeCmIUHPjeT22O185A+W2kCShFK46DXJLy9w/95dC6Vni+MVNolcN
            5Lf0jdONgMDdo+32zjII1n6iyo0p7wkBjMsGABFJoqTJAaMq5mwy9nF/sPIqdmaT
            q1YwBP3OeRZJ8YCvcundLS9HDkhal5+6/NFD57csm4bwbrccOpdarF0ebvy2cruk
            Zj677mBPENQjHQ6xoYKV4XiW1xsJ32Mn4ktBZuMlEpyuPKCj5d7xeFYobxOwZ1iE
            gV7CplBMIzXPzQ0bqocCqzWZfBrfRLAYZbMCAwEAAaOCAhwwggIYMA4GA1UdDwEB
            /wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDAYDVR0TAQH/
            BAIwADAdBgNVHQ4EFgQUJLJ8LKXFCuG8Uj+ME5ecw1M7tQYwHwYDVR0jBBgwFoAU
            u7zDR6XkvKnGw6RyDBCNojXhyOgwVwYIKwYBBQUHAQEESzBJMCIGCCsGAQUFBzAB
            hhZodHRwOi8vcjEwLm8ubGVuY3Iub3JnMCMGCCsGAQUFBzAChhdodHRwOi8vcjEw
            LmkubGVuY3Iub3JnLzAiBgNVHREEGzAZghdvbGQtcmVsZWFzZXMudWJ1bnR1LmNv
            bTATBgNVHSAEDDAKMAgGBmeBDAECATCCAQUGCisGAQQB1nkCBAIEgfYEgfMA8QB2
            AKLjCuRF772tm3447Udnd1PXgluElNcrXhssxLlQpEfnAAABlYe3tcEAAAQDAEcw
            RQIhAIB+Jcn3caERYoGN2pSv+s9M3jPJDoZ3JsbjCI8LIZwbAiBENMuiEGpWiAfn
            pKpPPLNmrjfiuuGraeB0C3iDmltTRgB3AHMgIg8IFor588SmiwqyappKAO71d4WK
            CE0FANSlQkRZAAABlYe3rjMAAAQDAEgwRgIhAK3HBjCK/Wyg8wn9vczPPFhCnYoG
            XypWziVOEdD4zWxEAiEAqc7As4gy1yS50cK5fqFlIiQ0U7C8jEb9UmmfRgK2kcMw
            DQYJKoZIhvcNAQELBQADggEBABhekTrH56X/E8iRdBBkHtmO7XvenVrCoVYPLdk7
            j2TFAB5JjatPB/wzcQnexvCngoOj0zE8xxqGx2JePNrxk2SzTWOfA1yXDWyVYsRd
            CYaykg6ZKxaoiV61UAgcEJUEzUstM9KRHbjDoy/ZMsemMpFdp38Q6AeoJS08jf1e
            sFvo2jqgMiPoKPLmnIzdoCKf0+WtHOJt6BBoAOxLAxrUnCtDfQvR1OFm3AkdUTeO
            fI1XhwcNnCvXV8xEVvPGupc44+4dKmHJfAiY+bQgH0Fcco/YxfZswcLPDKTxPXF/
            StRo1ZACCL0Bl98yeFMBJYu9s4zfaS9C8/1bd1jTxXk5+xU=
            -----END CERTIFICATE-----
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 2.12.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/infra-managers
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: infra-managers
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: infra/charts/infra-managers
    helm:
      releaseName: infra-managers
      valuesObject:
        attestationstatus-manager:
          image:
            pullPolicy: IfNotPresent
          inventory:
            addr: inventory.orch-infra.svc.cluster.local
          metrics:
            enabled: false
          multiTenancy:
            enforceMultiTenancy: "true"
          oidc:
            oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
          resources: null
          serviceArgs:
            enableTracing: false
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          traefikApiGroup: traefik.io/v1alpha1
          traefikReverseProxy:
            enabled: true
            host:
              grpc:
                name: Host(`attest-node.cluster.onprem`)
            secretName: tls-orch
            tlsOption: gateway-tls
        global:
          registry:
            imagePullSecrets: []
            name: registry-rs.edgeorchestration.intel.com/edge-orch/
        host-manager:
          image:
            pullPolicy: IfNotPresent
          inventory:
            addr: inventory.orch-infra.svc.cluster.local
          metrics:
            enabled: false
          multiTenancy:
            enforceMultiTenancy: "true"
          oidc:
            oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
          serviceArgs:
            enableTracing: false
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          traefikApiGroup: traefik.io/v1alpha1
          traefikReverseProxy:
            enabled: true
            host:
              grpc:
                name: Host(`infra-node.cluster.onprem`)
            secretName: tls-orch
            tlsOption: gateway-tls
        import: null
        maintenance-manager:
          image:
            pullPolicy: IfNotPresent
          inventory:
            addr: inventory.orch-infra.svc.cluster.local
          metrics:
            enabled: false
          mimaintmgr:
            enableTracing: false
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          multiTenancy:
            enforceMultiTenancy: "true"
          oidc:
            oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
          serviceArgs:
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          telemetryMgrArgs:
            enableVal: false
          traefikApiGroup: traefik.io/v1alpha1
          traefikReverseProxy:
            enabled: true
            host:
              grpc:
                name: Host(`update-node.cluster.onprem`)
            secretName: tls-orch
            tlsOption: gateway-tls
        networking-manager:
          image:
            pullPolicy: IfNotPresent
          metrics:
            enabled: false
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
          serviceArgs:
            enableTracing: false
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
        os-resource-manager:
          autoProvision: null
          global:
            proxies:
              http_proxy: null
              https_proxy: null
              no_proxy: null
          image:
            pullPolicy: IfNotPresent
          managerArgs:
            enableTracing: false
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            manualMode: false
            osProfileRevision: 0.10.2
            osSecurityFeatureEnable: false
            rsEnProfileRepo: edge-orch/en/files/os-profile/
            rsProxyFilesAddress: rs-proxy-files.orch-platform.svc.cluster.local:8081/
            rsProxyRegistryAddress: rs-proxy.orch-platform.svc.cluster.local:8081/
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          metrics:
            enabled: false
          multiTenancy:
            enforceMultiTenancy: "true"
          oidc:
            oidc_server_url: http://platform-keycloak.orch-platform.svc.cluster.local/realms/master
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
        telemetry-manager:
          image:
            pullPolicy: IfNotPresent
          metrics:
            enabled: false
          multiTenancy:
            enforceMultiTenancy: "true"
          oidc:
            oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
          telemetryMgrArgs:
            enableTracing: false
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          traefikApiGroup: traefik.io/v1alpha1
          traefikReverseProxy:
            enabled: true
            host:
              grpc:
                name: Host(`telemetry-node.cluster.onprem`)
            secretName: tls-orch
            tlsOption: gateway-tls
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 2.16.8
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/infra-onboarding
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: infra-onboarding
  namespace: onprem
spec:
  destination:
    namespace: orch-infra
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: infra/charts/infra-onboarding
    helm:
      releaseName: infra-onboarding
      valuesObject:
        dkam:
          env:
            mode: prod
            oidc:
              oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
            rs_proxy_address: rs-proxy.orch-platform.svc.cluster.local:8081/
          managerArgs:
            enableTracing: false
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          metrics:
            enabled: false
          proxies:
            http_proxy: null
            https_proxy: null
            no_proxy: null
          pvc:
            storageClassName: openebs-hostpath
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
        global:
          registry:
            imagePullSecrets: []
            name: registry-rs.edgeorchestration.intel.com/edge-orch/
        import:
          dkam:
            enabled: true
          onboarding-manager:
            enabled: true
          pxe-server:
            enabled: false
          tinkerbell:
            enabled: true
        infra-config:
          config:
            cdnSvc: files-rs.edgeorchestration.intel.com
            disableCoProfile: false
            disableO11yProfile: false
            embImageUrl: files-edge-orch/repository/microvisor/uos/emb_uos_x86_64_20251113.tar.gz
            enAgentManifestTag: 1.4.11
            enProxyFTP: null
            enProxyHTTP: null
            enProxyHTTPS: null
            enProxyNoProxy: null
            enProxySocks: null
            extraHosts: ""
            firewallCfgAllow: |-
              [{
                "sourceIp": "",
                "ports": "2379,2380,6443,9345,10250,5473",
                "ipVer": "",
                "protocol": "tcp"
              },
              {
                "sourceIp": "",
                "ports": "7946",
                "ipVer": "",
                "protocol": ""
              },
              {
                "sourceIp": "",
                "ports": "123",
                "ipVer": "",
                "protocol": "udp"
              }]
            firewallReqAllow: |-
              [{
                "sourceIp": "cluster.onprem",
                "ports": "6443,10250",
                "ipVer": "ipv4",
                "protocol": "tcp"
              }]
            nameServers: []
            netIp: dynamic
            ntpServer: pool.ntp.org
            omStreamSvc: onboarding-stream.cluster.onprem
            omSvc: onboarding-node.cluster.onprem
            orchAttestationStatus: attest-node.cluster.onprem:443
            orchCluster: cluster-orch-node.cluster.onprem:443
            orchDeviceManager: device-manager-node.cluster.onprem:443
            orchFileServer: files-rs.edgeorchestration.intel.com:60444
            orchInfra: infra-node.cluster.onprem:443
            orchKeycloak: keycloak.cluster.onprem:443
            orchMPSHost: mps.cluster.onprem:4433
            orchMPSWHost: mps-wss.cluster.onprem:443
            orchPlatformObsLogs: logs-node.cluster.onprem:443
            orchPlatformObsMetrics: metrics-node.cluster.onprem:443
            orchRPSHost: rps.cluster.onprem:443
            orchRPSWHost: rps-wss.cluster.onprem:443
            orchRegistry: registry-rs.edgeorchestration.intel.com:9443
            orchRelease: release.cluster.onprem
            orchTelemetry: telemetry-node.cluster.onprem:443
            orchUpdate: update-node.cluster.onprem:443
            provisioningSvc: tinkerbell-nginx.cluster.onprem
            rsType: no-auth
            systemConfigFsInotifyMaxUserInstances: "8192"
            systemConfigKernelPanic: "10"
            systemConfigKernelPanicOnOops: "1"
            systemConfigVmOverCommitMemory: "1"
            tinkerSvc: tinkerbell-server.cluster.onprem
        onboarding-manager:
          env:
            enableTinkActionTimestamp: false
            keycloakUrl: http://platform-keycloak.orch-platform.svc.cluster.local:8080
            mode: prod
            oidc:
              clients:
                bypass:
                - cdn-boots
              oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
            passWord: user
            tinkerActionsVersion: 1.20.0
            userName: user
            vaultRole: orch-svc
            vaultUrl: http://vault.orch-platform.svc.cluster.local:8200
          managerArgs:
            enableTracing: false
            inventoryAddress: inventory.orch-infra.svc.cluster.local:50051
            traceURL: orchestrator-observability-opentelemetry-collector.orch-platform.svc:4318
          metrics:
            enabled: false
          multiTenancy:
            enforceMultiTenancy: true
          pvc:
            storageClassName: openebs-hostpath
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 10m
              memory: 16Mi
          serviceAccount:
            name: orch-svc
          traefikApiGroup: traefik.io/v1alpha1
          traefikReverseProxy:
            enabled: true
            gatewayNamespace: orch-gateway
            host:
              grpc:
                name: onboarding-node.cluster.onprem
              stream:
                name: onboarding-stream.cluster.onprem
            secretName: tls-orch
            tlsOption: gateway-tls
        tinkerbell:
          pvc:
            enabled: false
            storageClassName: openebs-hostpath
          stack:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 200m
                memory: 256Mi
          tinkerbell_smee:
            additionalKernelArgs:
            - http_proxy=
            - https_proxy=
            - no_proxy=
            - HTTP_PROXY=
            - HTTPS_PROXY=
            - NO_PROXY=
            - DEBUG=false
            - TIMEOUT=120s
            - syslog_host=127.0.0.1
            traefikReverseProxy:
              enabled: true
              nginxDnsname: tinkerbell-nginx.cluster.onprem
          tinkerbell_tink:
            server:
              metrics:
                enabled: false
          traefikApiGroup: traefik.io/v1alpha1
          traefikReverseProxy:
            enabled: true
            gatewayNamespace: orch-gateway
            nginxDnsname: tinkerbell-nginx.cluster.onprem
            tinkServerDnsname: tinkerbell-server.cluster.onprem
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.34.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/ingress-haproxy
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: ingress-haproxy
  namespace: onprem
spec:
  destination:
    namespace: orch-boots
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: kubernetes-ingress
    helm:
      releaseName: ingress-nginx-controller
      valuesObject:
        controller:
          config:
            global-config-snippet: |
              ssl-default-bind-ciphers DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384
              ssl-default-bind-ciphersuites TLS_AES_256_GCM_SHA384
              ssl-default-bind-options ssl-min-ver TLSv1.2 ssl-max-ver TLSv1.3 no-tls-tickets
          defaultTLSSecret:
            enabled: true
            secretName: tls-boots
            secretNamespace: orch-boots
          extraArgs:
          - --default-ssl-certificate=orch-boots/tls-boots
          ingressClass: haproxy
          ingressClassResource:
            default: false
            enabled: true
            name: haproxy
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          service:
            annotations:
              metallb.universe.tf/address-pool: ingress-nginx-controller
            enablePorts:
              http: false
              https: true
              prometheus: false
              stat: false
            ipFamilies:
            - IPv4
            ipFamilyPolicy: SingleStack
            nameOverride: ingress-nginx-controller
            type: LoadBalancer
    repoURL: https://haproxytech.github.io/helm-charts
    targetRevision: 1.41.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/intel-infra-provider
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: intel-infra-provider
  namespace: onprem
spec:
  destination:
    namespace: orch-cluster
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: cluster/charts/intel-infra-provider
    helm:
      releaseName: intel-infra-provider
      valuesObject:
        manager:
          image:
            registry:
              name: registry-rs.edgeorchestration.intel.com/edge-orch
            repository: cluster/capi-provider-intel-manager
          inventory:
            endpoint: inventory.orch-infra.svc.cluster.local:50051
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        oidc:
          oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
        southboundApi:
          image:
            registry:
              name: registry-rs.edgeorchestration.intel.com/edge-orch
            repository: cluster/capi-provider-intel-southbound
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        traefikApiGroup: traefik.io/v1alpha1
        traefikReverseProxy:
          enabled: true
          host:
            grpc:
              name: cluster-orch-node.cluster.onprem
              secretName: tls-orch
              tlsOption: gateway-tls
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.3.4
  - chart: cluster/charts/intel-infra-provider-crds
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.3.4
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/istio-base
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: istio-base
  namespace: onprem
spec:
  destination:
    namespace: istio-system
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: admissionregistration.k8s.io
    jsonPointers:
    - /webhooks/0/failurePolicy
    kind: ValidatingWebhookConfiguration
    name: istiod-default-validator
  project: onprem
  sources:
  - chart: base
    helm:
      releaseName: istio-base
      valuesObject:
        global:
          proxy:
            resources:
              limits:
                cpu: 2000m
                memory: 1024Mi
              requests:
                cpu: 10m
                memory: 128Mi
        meshConfig:
          meshMTLS:
            minProtocolVersion: TLSV1_3
    repoURL: https://istio-release.storage.googleapis.com/charts
    targetRevision: 1.28.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "150"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/istio-policy
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: istio-policy
  namespace: onprem
spec:
  destination:
    namespace: istio-system
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/istio-policy
    helm:
      releaseName: istio-policy
      valuesObject: {}
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 2.0.7
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "110"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/istiod
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: istiod
  namespace: onprem
spec:
  destination:
    namespace: istio-system
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: admissionregistration.k8s.io
    jsonPointers:
    - /webhooks/0/failurePolicy
    kind: ValidatingWebhookConfiguration
    name: istio-validator-istio-system
  project: onprem
  sources:
  - chart: istiod
    helm:
      releaseName: istiod
      valuesObject:
        global:
          proxy:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        meshConfig:
          defaultConfig:
            holdApplicationUntilProxyStarts: true
          meshMTLS:
            minProtocolVersion: TLSV1_3
        pilot:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        podSecurityContext:
          seccompProfile:
            type: RuntimeDefault
        securityContext:
          seccompProfile:
            type: RuntimeDefault
        sidecarInjectorWebhook:
          neverInjectSelector:
          - matchExpressions:
            - key: job-name
              operator: Exists
            - key: app.kubernetes.io/name
              operator: NotIn
              values:
              - secrets-config
              - credentials
              - loca-credentials
              - cluster-manager
    repoURL: https://istio-release.storage.googleapis.com/charts
    targetRevision: 1.28.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/keycloak-operator
    description: Keycloak Operator for managing Keycloak instances via CRDs
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: keycloak-operator
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/keycloak-operator
    helm:
      releaseName: keycloak-operator
      valuesObject: {}
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.1.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - RespectIgnoreDifferences=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1250"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/keycloak-tenant-controller
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: keycloak-tenant-controller
  namespace: onprem
spec:
  destination:
    namespace: orch-gateway
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/keycloak-tenant-controller
    helm:
      releaseName: keycloak-tenant-controller
      valuesObject:
        argo:
          clusterDomain: cluster.onprem
        curlImage:
          name: badouralix/curl-jq@sha256
          pullPolicy: IfNotPresent
          tag: 8ee002ae4452b23a3c70750c5c081e95334cfe9f7968fb4d67a90d4001c29d0b
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
          repository: common/keycloak-tenant-controller
        imagePullSecrets: null
        keycloak_org_groups: |-
          {
            "<org-id>_Project-Manager-Group": [
              "<org-id>_project-read-role",
              "<org-id>_project-write-role",
              "<org-id>_project-update-role",
              "<org-id>_project-delete-role"
            ]
          }
        keycloak_proj_groups: |-
          {
            "<project-id>_Edge-Node-M2M-Service-Account": [
              "rs-access-r",
              "rs-proxy-r",
              "<project-id>_cat-r",
              "<project-id>_reg-r",
              "<project-id>_en-agent-rw"
            ],
            "<project-id>_Edge-Manager-Group": [
              "account/manage-account",
              "account/view-profile",
              "<project-id>_tc-r",
              "<project-id>_ao-rw",
              "<project-id>_cat-rw",
              "<project-id>_cl-rw",
              "<project-id>_cl-tpl-rw",
              "<project-id>_reg-a",
              "<project-id>_reg-r",
              "<project-id>_im-r",
              "<project-id>_alrt-rw",
              "<org-id>_<project-id>_m"
            ],
            "<project-id>_Edge-Onboarding-Group": [
              "rs-access-r",
              "<project-id>_en-ob"
            ],
            "<project-id>_Edge-Operator-Group": [
              "account/manage-account",
              "account/view-profile",
              "<project-id>_tc-r",
              "<project-id>_ao-rw",
              "<project-id>_cat-r",
              "<project-id>_cl-r",
              "<project-id>_cl-tpl-r",
              "<project-id>_reg-r",
              "<project-id>_im-r",
              "<project-id>_alrt-r",
              "<org-id>_<project-id>_m"
            ],
            "<project-id>_Host-Manager-Group": [
              "account/manage-account",
              "account/view-profile",
              "<project-id>_tc-r",
              "<project-id>_im-rw",
              "<project-id>_en-ob",
              "<org-id>_<project-id>_m"
            ]
          }
        keycloak_realm: master
        keycloak_si_groups: ""
        keycloakAdmin:
          client: system-client
          passwordSecret:
            key: admin-password
            name: platform-keycloak
          user: admin
        namespace: orch-platform
        podSecurityContext:
          seccompProfile:
            type: RuntimeDefault
        proxy:
          httpProxy: null
          httpsProxy: null
          noProxy: null
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        serviceAccount:
          annotations: {}
          name: orch-svc
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "150"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/kiali
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: kiali
  namespace: onprem
spec:
  destination:
    namespace: istio-system
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: ""
    jsonPointers:
    - /data
    kind: ConfigMap
    name: kiali
    namespace: istio-system
  - group: apps
    jsonPointers:
    - /spec/template/metadata/annotations/checksum~1config
    kind: Deployment
    name: kiali
    namespace: istio-system
  project: onprem
  sources:
  - chart: kiali-server
    helm:
      releaseName: kiali
      valuesObject:
        auth:
          strategy: anonymous
        containerSecurityContext:
          allowPrivilegeEscalation: false
          seccompProfile:
            type: RuntimeDefault
        deployment:
          image_pull_policy: IfNotPresent
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        external_services:
          prometheus:
            url: http://prometheus-operated.orch-platform.svc:9090/
        podSecurityContext:
          seccompProfile:
            type: RuntimeDefault
        securityContext:
          seccompProfile:
            type: RuntimeDefault
    repoURL: https://kiali.org/helm-charts
    targetRevision: 2.18.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/kyverno
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: kyverno
  namespace: onprem
spec:
  destination:
    namespace: kyverno
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: kyverno
    helm:
      releaseName: kyverno
      valuesObject:
        admissionController:
          container:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          initContainer:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          rbac:
            clusterRole:
              extraResources:
              - apiGroups:
                - '*'
                resources:
                - '*'
                verbs:
                - get
                - list
                - watch
          replicas: 3
        backgroundController:
          rbac:
            clusterRole:
              extraResources:
              - apiGroups:
                - '*'
                resources:
                - '*'
                verbs:
                - get
                - list
                - watch
          replicas: 2
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        cleanupController:
          replicas: 2
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        crds:
          migration:
            enabled: false
        features:
          policyExceptions:
            enabled: true
            namespace: kyverno
        reportsController:
          rbac:
            clusterRole:
              extraResources:
              - apiGroups:
                - '*'
                resources:
                - '*'
                verbs:
                - get
                - list
                - watch
          replicas: 2
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
    repoURL: https://kyverno.github.io/kyverno
    targetRevision: 3.6.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - Replace=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "105"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/kyverno-extra-policies
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: kyverno-extra-policies
  namespace: onprem
spec:
  destination:
    namespace: kyverno
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/kyverno-extra-policies
    helm:
      releaseName: kyverno-extra-policies
      valuesObject:
        require_ro_rootfs:
          FailureAction: Audit
          exclude:
            names: []
            namespaces: []
        restrictedPolicyOrch:
        - names:
          - iam-umbrella-nexus-api-gw-*
          namespace: orch-iam
        - names:
          - orchestrator-observability-opentelemetry-collector*
          - orchestrator-observability-opentelemetry-collector-daemonset-agent*
          - loki-backend*
          - orchestrator-observability-loki-gateway*
          - orchestrator-observability-loki-results-cache*
          - orchestrator-observability-loki-chunks-cache*
          - orchestrator-observability-minio*
          - orchestrator-observability-mimir-make-minio-buckets*
          - adm-secret*
          - keycloak-tenant-controller-set-*
          namespace: orch-platform
        - names:
          - alerting-monitor-alertmanager*
          - onboarding-manager*
          - edgenode-observability-mimir-make-minio-buckets*
          - loki-backend*
          - edgenode-observability-loki-gateway*
          - edgenode-observability-loki-results-cache*
          - edgenode-observability-loki-chunks-cache*
          - edgenode-observability-opentelemetry-collector*
          - edgenode-observability-minio*
          - dkam*
          - rps*
          - pxe-server*
          namespace: orch-infra
        - names:
          - web-ui-app-orch-*
          - web-ui-infra-*
          - web-ui-admin-*
          - web-ui-root-*
          - web-ui-cluster-orch-*
          - metadata-broker-orch-metadata-broker-*
          namespace: orch-ui
        - names:
          - capi-operator-cluster-api-operator-*
          namespace: capi-operator-system
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 3.0.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/kyverno-istio-policy
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: kyverno-istio-policy
  namespace: onprem
spec:
  destination:
    namespace: kyverno
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/kyverno-istio-policy
    helm:
      releaseName: kyverno-istio-policy
      valuesObject:
        excludedNamespaces:
        - argocd
        - cattle-fleet-clusters-system
        - cattle-fleet-local-system
        - cattle-fleet-system
        - cattle-global-data
        - cattle-global-nt
        - cattle-impersonation-system
        - cattle-provisioning-capi-system
        - cattle-system
        - cattle-ui-plugin-system
        - cert-manager
        - cluster-fleet-local-*
        - default
        - dev
        - dev-coder
        - ext
        - fleet-default
        - fleet-local
        - gitea
        - istio-system
        - kube-node-lease
        - kube-public
        - kube-system
        - kyverno
        - local
        - local-path-storage
        - metallb-system
        - ns-label
        - p-?????
        - mailpit-dev
        - kubeadm-control-plane-system
        - kubeadm-bootstrap-system
        - capi-variables
        - capi-system
        - capi-operator-system
        - capr-system
        - capk-system
        - postgresql-operator
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/kyverno-traefik-policy
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: kyverno-traefik-policy
  namespace: onprem
spec:
  destination:
    namespace: kyverno
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/kyverno-traefik-policy
    helm:
      releaseName: kyverno-traefik-policy
      valuesObject:
        anyMiddlewareException:
        - names:
          - orch-platform-grafana
          - orch-platform-vault
          - edgenode-observability-grafana
          - traefik-boots-ca-certificate
          - harbor-oci
          - svc-fleet-https
          - onboardingmgr-api-grpc-stream
          - cluster-connect-gateway-ws
          - cluster-connect-gateway-kubeapi
          namespace: orch-gateway
        jwtMiddlewareException:
        - names:
          - harbor-oci
          - ma-gitea
          - app-service-proxy
          - app-service-proxy-src
          - vnc-proxy-app-resource-manager-websocket-server
          - traefik-boots-ca-certificate
          - common-log-query-rest-proxy
          - web-ui-root
          - web-ui-infra
          - svc-fleet-https
          - onboardingmgr-api-grpc-stream
          - iam-umbrella-nexus-api-gw-api-docs
          - cluster-connect-gateway-ws
          - cluster-connect-gateway-kubeapi
          - orch-platform-keycloak
          - amt-api-rps
          namespace: orch-gateway
        - names:
          - tinkerbell-nginx-ingress
          namespace: orch-boots
        traefikApiGroup: traefik.io/v1alpha1
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/metadata-broker
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: metadata-broker
  namespace: onprem
spec:
  destination:
    namespace: orch-ui
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: orch-ui/charts/orch-metadata-broker
    helm:
      releaseName: metadata-broker
      valuesObject:
        global:
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        opaResources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        openidc:
          issuer: http://platform-keycloak.orch-platform.svc/realms/master
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        service:
          traefik:
            hostname: Host(`metadata.cluster.onprem`)
            namespace: orch-gateway
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.0.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/metallb
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: metallb
  namespace: onprem
spec:
  destination:
    namespace: metallb-system
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: apiextensions.k8s.io
    jsonPointers:
    - /spec/conversion/webhook/clientConfig/caBundle
    kind: CustomResourceDefinition
    name: bgppeers.metallb.io
  project: onprem
  sources:
  - chart: metallb
    helm:
      releaseName: metallb
      valuesObject:
        speaker:
          frr:
            enabled: false
    repoURL: https://metallb.github.io/metallb
    targetRevision: 0.15.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "150"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/metallb-config
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: metallb-config
  namespace: onprem
spec:
  destination:
    namespace: metallb-system
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/metallb-config
    helm:
      releaseName: metallb-config
      valuesObject:
        ArgoIP: 192.168.99.20
        IPEnd: 10.43.100.255
        IPStart: 10.43.100.0
        NginxIP: 192.168.99.40
        TraefikIP: 192.168.99.30
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "90"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/namespace-label
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: namespace-label
  namespace: onprem
spec:
  destination:
    namespace: ns-label
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/namespace-label
    helm:
      releaseName: namespace-label
      valuesObject:
        namespaces:
        - labels:
            istio-injection: enabled
          name: orch-infra
        - labels:
            istio-injection: enabled
          name: orch-iam
        - labels:
            istio-injection: enabled
          name: orch-app
        - labels:
            istio-injection: enabled
          name: orch-cluster
        - labels:
            istio-injection: enabled
          name: orch-ui
        - labels:
            istio-injection: enabled
          name: orch-platform
        - labels:
            istio-injection: enabled
          name: orch-harbor
        - labels:
            istio-injection: enabled
          name: orch-gateway
        - labels:
            istio-injection: enabled
          name: orch-sre
        - labels:
            istio-injection: enabled
          name: orch-database
        - labels:
            istio-injection: enabled
          name: orch-boots
        - labels:
            istio-injection: enabled
          name: orch-secret
        - labels:
            app.edge-orchestrator.intel.com/fleet-rs-secret: "true"
          name: fleet-default
        - name: capi-variables
        resources: null
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1200"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/nexus-api-gw
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: nexus-api-gw
  namespace: onprem
spec:
  destination:
    namespace: orch-iam
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/nexus-api-gw
    helm:
      releaseName: nexus-api-gw
      valuesObject:
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
          repository: common/nexus-api-gw
        imagePullSecrets: null
        oidc:
          name: keycloak-api
          oidc_env_name: OIDC_SERVER_URL
          oidc_server_url: http://platform-keycloak.orch-platform.svc/realms/master
          oidc_tls_insecure_skip_verify_env_name: OIDC_TLS_INSECURE_SKIP_VERIFY
          oidc_tls_insecure_skip_verify_value: "true"
        traefikApiGroup: traefik.io/v1alpha1
        traefikReverseProxy:
          enabled: true
          host:
            grpc:
              name: api.cluster.onprem
          matchRoute: null
          middlewares:
            enabled: true
          secretName: tls-orch
          tlsOption: gateway-tls
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2005"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/observability-tenant-controller
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: observability-tenant-controller
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: o11y/charts/observability-tenant-controller
    helm:
      releaseName: observability-tenant-controller
      valuesObject:
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
        imagePullSecrets: null
        sre:
          enabled: true
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 0.7.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/orchestrator-dashboards
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: orchestrator-dashboards
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: o11y/charts/orchestrator-dashboards
    helm:
      releaseName: orchestrator-dashboards
      valuesObject: {}
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 0.3.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - ServerSideApply=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/orchestrator-observability
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: orchestrator-observability
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: o11y/charts/orchestrator-observability
    helm:
      releaseName: orchestrator-observability
      valuesObject:
        grafana:
          grafana.ini:
            auth:
              signout_redirect_url: https://keycloak.cluster.onprem/realms/master/protocol/openid-connect/logout?redirect_uri=https%3A%2F%2Fweb-ui.cluster.onprem
            auth.generic_oauth:
              auth_url: https://keycloak.cluster.onprem/realms/master/protocol/openid-connect/auth
            server:
              root_url: https://observability-admin.cluster.onprem
          grafana_proxy:
            registry: registry-rs.edgeorchestration.intel.com/edge-orch
          imagePullSecrets: null
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          sidecar:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        loki:
          backend:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          chunksCache:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          gateway:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          loki:
            commonConfig:
              replication_factor: 3
            compactor:
              retention_enabled: true
            limits_config:
              retention_period: 24h
            storage:
              s3:
                endpoint: orchestrator-observability-minio:9000
          memcachedExporter:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          minio:
            image:
              tag: RELEASE.2025-09-07T16-13-09Z
            mcImage:
              tag: RELEASE.2025-08-13T08-35-41Z
          read:
            persistence:
              size: 8Gi
            replicas: 3
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          resultsCache:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          sidecar:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          write:
            persistence:
              size: 8Gi
            replicas: 2
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        mimir-distributed:
          compactor:
            persistentVolume:
              size: 18Gi
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          distributor:
            replicas: 1
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          gateway:
            ingress:
              enabled: false
            nginx:
              config:
                serverSnippet: |
                  client_header_buffer_size 64k;
                  large_client_header_buffers 64 128k;
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          ingester:
            persistentVolume:
              size: 12Gi
            replicas: 2
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          kafka:
            enabled: false
          mimir:
            structuredConfig:
              blocks_storage:
                backend: s3
                tsdb:
                  wal_compression_enabled: true
              distributor:
                remote_timeout: null
              ingest_storage:
                enabled: false
                kafka:
                  address: null
                  auto_create_topic_default_partitions: null
                  topic: null
              ingester:
                push_grpc_method_enabled: true
              limits:
                compactor_blocks_retention_period: 24h
              ruler_storage:
                backend: s3
          minio:
            deploymentUpdate:
              type: Recreate
            image:
              tag: RELEASE.2025-09-07T16-13-09Z
            makeBucketJob:
              exitCommand: ""
            makePolicyJob:
              exitCommand: ""
            makeUserJob:
              exitCommand: ""
            mcImage:
              tag: RELEASE.2025-08-13T08-35-41Z
            persistence:
              size: 18Gi
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          querier:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          query_frontend:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          query_scheduler:
            enabled: true
          ruler:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          store_gateway:
            persistentVolume:
              size: 5Gi
            replicas: 1
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
        opentelemetry-collector:
          alternateConfig:
            processors:
              probabilistic_sampler:
                sampling_percentage: 50
            receivers:
              otlp:
                protocols:
                  grpc:
                    endpoint: ${env:MY_POD_IP}:4317
                  http:
                    endpoint: ${env:MY_POD_IP}:4318
                    include_metadata: true
            service:
              telemetry:
                metrics:
                  level: detailed
                  readers:
                  - pull:
                      exporter:
                        prometheus:
                          host: ${env:MY_POD_IP}
                          port: 8888
                          without_type_suffix: true
                          without_units: true
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        opentelemetry-collector-daemonset:
          alternateConfig:
            receivers:
              otlp:
                protocols:
                  grpc:
                    endpoint: ${env:MY_POD_IP}:4317
                  http:
                    endpoint: ${env:MY_POD_IP}:4318
                    include_metadata: true
              prometheus:
                config:
                  scrape_configs:
                  - job_name: opentelemetry-collector
                    scrape_interval: 10s
                    static_configs:
                    - targets:
                      - ${env:MY_POD_IP}:8888
            service:
              telemetry:
                metrics:
                  level: detailed
                  readers:
                  - pull:
                      exporter:
                        prometheus:
                          host: ${env:MY_POD_IP}
                          port: 8888
                          without_type_suffix: true
                          without_units: true
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 0.5.15
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/orchestrator-prometheus-agent
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: orchestrator-prometheus-agent
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: kube-prometheus-stack
    helm:
      releaseName: orchestrator-prometheus-agent
      valuesObject:
        alertmanager:
          enabled: false
        containerSecurityContext:
          allowPrivilegeEscalation: false
        coreDns:
          enabled: false
        crds:
          enabled: false
        defaultRules:
          create: false
        grafana:
          enabled: false
        kube-state-metrics:
          prometheus:
            monitor:
              enabled: true
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        kubeApiServer:
          enabled: true
        kubeControllerManager:
          enabled: false
        kubeEtcd:
          enabled: false
        kubeProxy:
          enabled: false
        kubeScheduler:
          enabled: false
        kubeStateMetrics:
          enabled: true
        kubelet:
          enabled: false
        kubeletService:
          enabled: false
        kubernetesServiceMonitors:
          enabled: true
        nodeExporter:
          enabled: false
        prometheus:
          agentMode: false
          enabled: true
          prometheusSpec:
            evaluationInterval: 60s
            podMetadata:
              annotations:
                traffic.sidecar.istio.io/excludeOutboundPorts: "15090"
            podMonitorSelectorNilUsesHelmValues: false
            probeSelectorNilUsesHelmValues: false
            remoteWrite:
            - headers:
                X-Scope-OrgID: orchestrator-system
              name: orchestrator-admin
              url: http://orchestrator-observability-mimir-gateway:8181/api/v1/push
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
            retention: 24h
            ruleNamespaceSelector:
              matchLabels:
                kubernetes.io/metadata.name: orch-platform
            ruleSelectorNilUsesHelmValues: false
            scrapeInterval: 60s
            serviceMonitorSelectorNilUsesHelmValues: false
        prometheus-node-exporter:
          prometheus:
            monitor:
              enabled: false
        prometheusOperator:
          admissionWebhooks:
            enabled: false
          alertmanagerConfigNamespaces:
          - orch-platform
          alertmanagerInstanceNamespaces:
          - orch-platform
          enabled: true
          prometheusConfigReloader:
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
          prometheusInstanceNamespaces:
          - orch-platform
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          tls:
            enabled: false
    repoURL: https://prometheus-community.github.io/helm-charts
    targetRevision: 79.7.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "150"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/platform-autocert
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: platform-autocert
  namespace: onprem
spec:
  destination:
    namespace: cert-manager
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: cert-manager.io
    jsonPointers:
    - /spec/acme/email
    kind: ClusterIssuer
  - group: cert-manager.io
    jsonPointers:
    - /spec/isCA
    kind: Certificate
  project: onprem
  sources:
  - chart: common/charts/platform-autocert
    helm:
      releaseName: platform-autocert
      valuesObject:
        certDomain: cluster.onprem
        generateOrchCert: true
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 1.0.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - Replace=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "150"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/platform-keycloak
    description: Keycloak instance deployed via Operator
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: platform-keycloak
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/keycloak-instance
    helm:
      releaseName: platform-keycloak
      valuesObject:
        argo:
          clusterDomain: cluster.onprem
          proxy:
            httpProxy: http://proxy-dmz.intel.com:912
            httpsProxy: http://proxy-dmz.intel.com:912
            noProxy: localhost,svc,cluster.local,default,internal,caas.intel.com,certificates.intel.com,localhost,127.0.0.0/8,10.0.0.0/8,192.168.0.0/16,172.16.0.0/12,169.254.169.254,orch-platform,orch-app,orch-cluster,orch-infra,orch-database,cattle-system,orch-secret,s3.amazonaws.com,s3.us-west-2.amazonaws.com,ec2.us-west-2.amazonaws.com,eks.amazonaws.com,elb.us-west-2.amazonaws.com,dkr.ecr.us-west-2.amazonaws.com,espd.infra-host.com,pid.infra-host.com,espdqa.infra-host.com,argocd-repo-server
        keycloak:
          additionalOptions:
          - name: db-url-host
            secret:
              key: PGHOST
              name: platform-keycloak-local-postgresql
          - name: db-url-port
            secret:
              key: PGPORT
              name: platform-keycloak-local-postgresql
          - name: db-url-database
            secret:
              key: PGDATABASE
              name: platform-keycloak-local-postgresql
          - name: hostname-url
            secret:
              key: PGDATABASE
              name: platform-keycloak-local-postgresql
          - name: hostname-strict
            value: "false"
          - name: proxy-address-forwarding
            value: "true"
          - name: http-relative-path
            value: /
          - name: http-enabled
            value: "true"
          - name: db-url-properties
            value: ?tcpKeepAlives=true&socketTimeout=120&connectTimeout=120
          - name: http-management-port
            value: "9000"
          - name: spi-login-protocol-openid-connect-legacy-logout-redirect-uri
            value: "true"
          - name: spi-brute-force-protector-default-brute-force-detector-allow-concurrent-requests
            value: "true"
          - name: log-level
            value: INFO
          - name: log-console-output
            value: json
          bootstrapAdmin:
            user:
              secret: platform-keycloak
          database:
            passwordSecret:
              key: PGPASSWORD
              name: platform-keycloak-local-postgresql
            usernameSecret:
              key: PGUSER
              name: platform-keycloak-local-postgresql
        keycloakConfigCli:
          configMap:
            labels:
              app.kubernetes.io/instance: keycloak-config-cli
              app.kubernetes.io/name: keycloak-config-cli
            name: keycloak-config-cli-realm-master
            namespace: orch-platform
          enabled: true
          job:
            backoffLimit: 5
            container:
              env:
              - name: KEYCLOAK_URL
                value: http://platform-keycloak.orch-platform.svc.cluster.local/
              - name: KEYCLOAK_USER
                valueFrom:
                  secretKeyRef:
                    key: username
                    name: platform-keycloak
              - name: KEYCLOAK_PASSWORD
                valueFrom:
                  secretKeyRef:
                    key: password
                    name: platform-keycloak
              - name: KEYCLOAK_AVAILABILITYCHECK_ENABLED
                value: "true"
              - name: KEYCLOAK_AVAILABILITYCHECK_TIMEOUT
                value: 120s
              - name: IMPORT_VARSUBSTITUTION_ENABLED
                value: "true"
              - name: IMPORT_FILES_LOCATIONS
                value: /config/*
              - name: IMPORT_MANAGED_GROUP
                value: no-delete
              - name: IMPORT_MANAGED_REQUIRED_ACTION
                value: no-delete
              - name: IMPORT_MANAGED_ROLE
                value: no-delete
              - name: IMPORT_MANAGED_CLIENT
                value: no-delete
              - name: IMPORT_MANAGED_USER
                value: no-delete
              - name: IMPORT_REMOTE_STATE_ENABLED
                value: "true"
              - name: LOGGING_LEVEL_ROOT
                value: INFO
              - name: LOGGING_LEVEL_KEYCLOAKCONFIGCLI
                value: DEBUG
              image: docker.io/adorsys/keycloak-config-cli:6.4.0-26
              imagePullPolicy: IfNotPresent
              name: keycloak-config-cli
              resources:
                limits:
                  cpu: 1000m
                  memory: 1Gi
                requests:
                  cpu: 200m
                  memory: 512Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                  - ALL
                readOnlyRootFilesystem: true
                runAsGroup: 65534
                runAsNonRoot: true
                runAsUser: 65534
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
              - mountPath: /config
                name: config
                readOnly: true
              - mountPath: /tmp
                name: tmp
            initContainers:
            - command:
              - sh
              - -c
              - |
                set -e
                echo "Waiting for Keycloak to be ready..."
                MAX_ATTEMPTS=60
                ATTEMPT=0
                while [ $ATTEMPT -lt $MAX_ATTEMPTS ]; do
                  if timeout 2 sh -c "echo '' | nc -w1 platform-keycloak.orch-platform.svc 8080" >/dev/null 2>&1; then
                    echo "Keycloak port 8080 is open!"
                    exit 0
                  fi
                  ATTEMPT=$((ATTEMPT + 1))
                  echo "Attempt $ATTEMPT/$MAX_ATTEMPTS - Waiting for Keycloak..."
                  sleep 5
                done
                echo "WARNING: Keycloak did not respond, but proceeding anyway..."
                exit 0
              image: busybox:1.36
              imagePullPolicy: IfNotPresent
              name: wait-for-keycloak
              resources:
                limits:
                  cpu: 100m
                  memory: 128Mi
                requests:
                  cpu: 50m
                  memory: 64Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                  - ALL
                readOnlyRootFilesystem: true
                runAsGroup: 65534
                runAsNonRoot: true
                runAsUser: 65534
                seccompProfile:
                  type: RuntimeDefault
            labels:
              app.kubernetes.io/instance: keycloak-config-cli
              app.kubernetes.io/name: keycloak-config-cli
              app.kubernetes.io/version: 6.4.0
            name: keycloak-config-cli
            namespace: orch-platform
            podLabels:
              sidecar.istio.io/inject: "false"
            restartPolicy: Never
            securityContext:
              fsGroup: 65534
              runAsGroup: 65534
              runAsNonRoot: true
              runAsUser: 65534
              seccompProfile:
                type: RuntimeDefault
            ttlSecondsAfterFinished: 3600
            volumes:
            - configMap:
                defaultMode: 292
                name: keycloak-config-cli-realm-master
              name: config
            - emptyDir: {}
              name: tmp
          serviceAccount:
            labels:
              app.kubernetes.io/instance: keycloak-config-cli
              app.kubernetes.io/name: keycloak-config-cli
              app.kubernetes.io/version: 6.4.0
            name: keycloak-config-cli
            namespace: orch-platform
        namespace: orch-platform
        realmMaster: |
          {
            "realm": "master",
            "accountTheme": "keycloak",
            "displayName": "Keycloak",
            "displayNameHtml": "<img src='https://raw.githubusercontent.com/open-edge-platform/orch-utils/73df5d1e99a81ae333d94b1c47dd9bef7fa03ae9/keycloak/one-edge-platform-login-title.png'></img>",
            "defaultSignatureAlgorithm": "PS512",
            "accessTokenLifespan": 3600,
            "ssoSessionIdleTimeout": 5400,
            "ssoSessionMaxLifespan": 43200,
            "passwordPolicy": "length(14) and digits(1) and specialChars(1) and upperCase(1) and lowerCase(1)",
            "bruteForceProtected": true,
            "permanentLockout": false,
            "maxFailureWaitSeconds": 900,
            "minimumQuickLoginWaitSeconds": 60,
            "waitIncrementSeconds": 300,
            "quickLoginCheckMilliSeconds": 200,
            "maxDeltaTimeSeconds": 43200,
            "failureFactor": 1000,
            "roles": {
              "realm": [
                {
                  "name": "en-agent-rw"
                },
                {
                  "name": "secrets-root-role"
                },
                {
                  "name": "rs-access-r"
                },
                {
                  "name": "rs-proxy-r"
                },
                {
                  "name": "app-service-proxy-read-role"
                },
                {
                  "name": "app-service-proxy-write-role"
                },
                {
                  "name": "app-deployment-manager-read-role"
                },
                {
                  "name": "app-deployment-manager-write-role"
                },
                {
                  "name": "app-resource-manager-read-role"
                },
                {
                  "name": "app-resource-manager-write-role"
                },
                {
                  "name": "app-vm-console-write-role"
                },
                {
                  "name": "catalog-publisher-read-role"
                },
                {
                  "name": "catalog-publisher-write-role"
                },
                {
                  "name": "catalog-other-read-role"
                },
                {
                  "name": "catalog-other-write-role"
                },
                {
                  "name": "catalog-restricted-read-role"
                },
                {
                  "name": "catalog-restricted-write-role"
                },
                {
                  "name": "clusters-read-role"
                },
                {
                  "name": "clusters-write-role"
                },
                {
                  "name": "cluster-templates-read-role"
                },
                {
                  "name": "cluster-templates-write-role"
                },
                {
                  "name": "cluster-artifacts-read-role"
                },
                {
                  "name": "cluster-artifacts-write-role"
                },
                {
                  "name": "infra-manager-core-read-role"
                },
                {
                  "name": "infra-manager-core-write-role"
                },
                {
                  "name": "alrt-r"
                },
                {
                  "name": "alrt-rw"
                },
                {
                  "name": "alrt-rx-rw"
                },
                {
                  "name": "ao-m2m-rw"
                },
                {
                  "name": "co-m2m-rw"
                },
                {
                  "name": "org-read-role"
                },
                {
                  "name": "org-write-role"
                },
                {
                  "name": "org-update-role"
                },
                {
                  "name": "org-delete-role"
                }
              ],
              "client": {
                "alerts-m2m-client": [],
                "host-manager-m2m-client": [],
                "co-manager-m2m-client": [],
                "ktc-m2m-client": [],
                "3rd-party-host-manager-m2m-client": [],
                "edge-manager-m2m-client": [],
                "en-m2m-template-client": [],
                "webui-client": [],
                "docsui-client": [],
                "account": [
                  {
                    "name": "view-profile",
                    "clientRole": true
                  },
                  {
                    "name": "manage-account",
                    "clientRole": true
                  }
                ],
                "telemetry-client": [
                  {
                    "name": "admin",
                    "clientRole": true
                  },
                  {
                    "name": "viewer",
                    "clientRole": true
                  }
                ],
                "cluster-management-client": [
                  {
                    "name": "restricted-role",
                    "clientRole": true
                  },
                  {
                    "name": "standard-role",
                    "clientRole": true
                  },
                  {
                    "name": "base-role",
                    "clientRole": true
                  }
                ],
                "registry-client": [
                  {
                    "name": "registry-admin-role",
                    "clientRole": true
                  },
                  {
                    "name": "registry-editor-role",
                    "clientRole": true
                  },
                  {
                    "name": "registry-viewer-role",
                    "clientRole": true
                  }
                ]
              }
            },
            "clients": [
              {
                "clientId": "alerts-m2m-client",
                "name": "Alerts M2M Client",
                "description": "Client for Alerts",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": false,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": true,
                "authorizationServicesEnabled": true,
                "publicClient": false,
                "protocol": "openid-connect",
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "service_account",
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "host-manager-m2m-client",
                "name": "Host Manager Client",
                "description": "Client for the EN Host Manager to use in creating edgenode m2m clients",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": false,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": true,
                "authorizationServicesEnabled": true,
                "publicClient": false,
                "frontchannelLogout": true,
                "protocol": "openid-connect",
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.session.required": "true",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "service_account",
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "co-manager-m2m-client",
                "name": "Cluster Orchestrator Manager M2M Client",
                "description": "Client for cluster-manager to access Keycloak for JWT TTL management",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": false,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": true,
                "authorizationServicesEnabled": true,
                "publicClient": false,
                "frontchannelLogout": true,
                "protocol": "openid-connect",
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.session.required": "true",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "service_account",
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "groups",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "offline_access"
                ]
              },
              {
                "clientId": "ktc-m2m-client",
                "name": "Keycloak Tenant Controller client",
                "description": "Client for the Keycloak Tenant Controller to use in creating Tenant specific roles and groups in Keycloak",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": false,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": true,
                "authorizationServicesEnabled": true,
                "publicClient": false,
                "frontchannelLogout": true,
                "protocol": "openid-connect",
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.session.required": "true",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "service_account",
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "groups",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "3rd-party-host-manager-m2m-client",
                "name": "3rd Party Host Manager Client",
                "description": "Client for the 3rd party Host Manager to use in creating edgenode m2m clients",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": false,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": true,
                "authorizationServicesEnabled": true,
                "publicClient": false,
                "frontchannelLogout": true,
                "protocol": "openid-connect",
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.session.required": "true",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "service_account",
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "edge-manager-m2m-client",
                "name": "Edge Manager M2M Client",
                "description": "Client for the accessing Orchestrator with Edge-Manager persona",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": false,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": true,
                "authorizationServicesEnabled": true,
                "publicClient": false,
                "frontchannelLogout": true,
                "protocol": "openid-connect",
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.session.required": "true",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "service_account",
                  "roles",
                  "groups",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "offline_access"
                ]
              },
              {
                "clientId": "en-m2m-template-client",
                "name": "Edge Node M2M Template Client",
                "description": "Client to use as basis for Roles to assign to new Edge Node M2M clients",
                "surrogateAuthRequired": false,
                "enabled": false,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": false,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": true,
                "authorizationServicesEnabled": true,
                "publicClient": false,
                "protocol": "openid-connect",
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "service_account",
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "telemetry-client",
                "name": "Telemetry Client",
                "rootUrl": "https://observability-ui.cluster.onprem",
                "enabled": true,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": ["https://observability-admin.cluster.onprem/login/generic_oauth","https://observability-ui.cluster.onprem/login/generic_oauth"],
                "webOrigins": [
                  "+"
                ],
                "protocol": "openid-connect",
                "directAccessGrantsEnabled": true,
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "client.secret.creation.time": "1683218404",
                  "backchannel.logout.session.required": "true",
                  "post.logout.redirect.uris": "+",
                  "display.on.consent.screen": "false",
                  "use.jwks.url": "false",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "roles",
                  "profile",
                  "email",
                  "basic"
                ],
                "optionalClientScopes": [
                  "groups",
                  "offline_access"
                ]
              },
              {
                "clientId": "cluster-management-client",
                "name": "Cluster Management Client",
                "rootUrl": "https://cluster-management.cluster.onprem",
                "adminUrl": "https://cluster-management.cluster.onprem",
                "surrogateAuthRequired": false,
                "enabled": true,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": ["https://cluster-management.cluster.onprem","https://cluster-management.cluster.onprem/"],
                "webOrigins": [
                  "+"
                ],
                "directAccessGrantsEnabled": true,
                "serviceAccountsEnabled": false,
                "publicClient": true,
                "frontchannelLogout": true,
                "protocol": "openid-connect",
                "attributes": {
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.revoke.offline.tokens": "false",
                  "use.refresh.tokens": "true",
                  "oidc.ciba.grant.enabled": "false",
                  "backchannel.logout.session.required": "true",
                  "client_credentials.use_refresh_token": "false",
                  "require.pushed.authorization.requests": "false",
                  "tls.client.certificate.bound.access.tokens": "false",
                  "display.on.consent.screen": "false",
                  "token.response.type.bearer.lower-case": "false"
                },
                "fullScopeAllowed": true,
                "protocolMappers": [
                  {
                    "name": "Group Path",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-group-membership-mapper",
                    "consentRequired": false,
                    "config": {
                      "full.path": "true",
                      "id.token.claim": "false",
                      "access.token.claim": "false",
                      "claim.name": "full_group_path",
                      "userinfo.token.claim": "true"
                    }
                  },
                  {
                    "name": "Groups Mapper",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-group-membership-mapper",
                    "consentRequired": false,
                    "config": {
                      "full.path": "false",
                      "id.token.claim": "false",
                      "access.token.claim": "false",
                      "claim.name": "groups",
                      "userinfo.token.claim": "true"
                    }
                  },
                  {
                    "name": "Client Audience",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-audience-mapper",
                    "consentRequired": false,
                    "config": {
                      "included.client.audience": "cluster-management-client",
                      "id.token.claim": "false",
                      "access.token.claim": "true"
                    }
                  }
                ],
                "defaultClientScopes": [
                  "profile",
                  "roles",
                  "email",
                  "basic"
                ],
                "optionalClientScopes": [
                  "groups",
                  "offline_access",
                ],
                "authorizationServicesEnabled": false
              },
              {
                "clientId": "webui-client",
                "name": "WebUI Client",
                "rootUrl": "https://web-ui.cluster.onprem",
                "enabled": true,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": ["https://web-ui.cluster.onprem","https://app-service-proxy.cluster.onprem/app-service-proxy-index.html*","https://vnc.cluster.onprem/*","https://cluster.onprem"],
                "webOrigins": [
                  "+"
                ],
                "protocol": "openid-connect",
                "directAccessGrantsEnabled": false,
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "client.secret.creation.time": "1683218404",
                  "backchannel.logout.session.required": "true",
                  "post.logout.redirect.uris": "+",
                  "display.on.consent.screen": "false",
                  "oauth2.device.authorization.grant.enabled": "true",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "roles",
                  "profile",
                  "email",
                  "basic"
                ],
                "optionalClientScopes": [
                  "groups",
                  "offline_access"
                ]
              },
              {
                "clientId": "docsui-client",
                "name": "DocsUI Client",
                "rootUrl": "https://docs-ui.cluster.onprem",
                "enabled": true,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": ["https://docs-ui.cluster.onprem","https://docs-ui.cluster.onprem/"],
                "webOrigins": [
                  "+"
                ],
                "protocol": "openid-connect",
                "directAccessGrantsEnabled": false,
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "client.secret.creation.time": "1683218404",
                  "backchannel.logout.session.required": "true",
                  "post.logout.redirect.uris": "+",
                  "display.on.consent.screen": "false",
                  "oauth2.device.authorization.grant.enabled": "true",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "roles",
                  "profile",
                  "email",
                  "basic"
                ],
                "optionalClientScopes": [
                  "groups",
                  "offline_access"
                ]
              },

              {
                "frontchannelLogout": true,
                "standardFlowEnabled": true,
                "clientId": "registry-client",
                "name": "Registry Client",
                "rootUrl": "https://registry-oci.cluster.onprem",
                "enabled": true,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": [
                  "/c/oidc/callback"
                ],
                "webOrigins": [
                  "+"
                ],
                "protocol": "openid-connect",
                "directAccessGrantsEnabled": true,
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "client.secret.creation.time": "1683218404",
                  "backchannel.logout.session.required": "true",
                  "post.logout.redirect.uris": "+",
                  "display.on.consent.screen": "false",
                  "use.jwks.url": "false",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "roles",
                  "profile",
                  "email",
                  "groups",
                  "basic"
                ],
                "optionalClientScopes": [
                  "offline_access"
                ]
              },
              {
                "clientId": "system-client",
                "name": "System Client",
                "description": "Public client for Resource Owner Password Credentials grant flow (admin API access)",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": [],
                "webOrigins": [],
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": false,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": true,
                "serviceAccountsEnabled": false,
                "publicClient": true,
                "frontchannelLogout": true,
                "protocol": "openid-connect",
                "attributes": {
                  "realm_client": "false",
                  "oidc.ciba.grant.enabled": "false",
                  "backchannel.logout.session.required": "true",
                  "oauth2.device.authorization.grant.enabled": "true",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "authenticationFlowBindingOverrides": {},
                "fullScopeAllowed": true,
                "nodeReRegistrationTimeout": -1,
                "defaultClientScopes": [
                  "openid",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "offline_access",
                  "groups"
                ]
              },
              {
                "clientId": "account",
                "name": "${client_account}",
                "rootUrl": "${authBaseUrl}",
                "baseUrl": "/realms/master/account/",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": [
                  "/realms/master/account/*"
                ],
                "webOrigins": [],
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": true,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": false,
                "publicClient": true,
                "frontchannelLogout": false,
                "protocol": "openid-connect",
                "attributes": {
                  "realm_client": "false",
                  "post.logout.redirect.uris": "+"
                },
                "authenticationFlowBindingOverrides": {},
                "fullScopeAllowed": false,
                "nodeReRegistrationTimeout": 0,
                "defaultClientScopes": [
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "organization",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "account-console",
                "name": "${client_account-console}",
                "rootUrl": "${authBaseUrl}",
                "baseUrl": "/realms/master/account/",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": [
                  "/realms/master/account/*"
                ],
                "webOrigins": [],
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": true,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": false,
                "publicClient": true,
                "frontchannelLogout": false,
                "protocol": "openid-connect",
                "attributes": {
                  "realm_client": "false",
                  "post.logout.redirect.uris": "+",
                  "pkce.code.challenge.method": "S256"
                },
                "authenticationFlowBindingOverrides": {},
                "fullScopeAllowed": false,
                "nodeReRegistrationTimeout": 0,
                "protocolMappers": [
                  {
                    "name": "audience resolve",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-audience-resolve-mapper",
                    "consentRequired": false,
                    "config": {}
                  }
                ],
                "defaultClientScopes": [
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "organization",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "broker",
                "name": "${client_broker}",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": [],
                "webOrigins": [],
                "notBefore": 0,
                "bearerOnly": true,
                "consentRequired": false,
                "standardFlowEnabled": true,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": false,
                "publicClient": false,
                "frontchannelLogout": false,
                "protocol": "openid-connect",
                "attributes": {
                  "realm_client": "true"
                },
                "authenticationFlowBindingOverrides": {},
                "fullScopeAllowed": false,
                "nodeReRegistrationTimeout": 0,
                "defaultClientScopes": [
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "organization",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "security-admin-console",
                "name": "${client_security-admin-console}",
                "rootUrl": "${authAdminUrl}",
                "baseUrl": "/admin/master/console/",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": [
                  "/admin/master/console/*"
                ],
                "webOrigins": [
                  "+"
                ],
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": true,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": false,
                "publicClient": true,
                "frontchannelLogout": false,
                "protocol": "openid-connect",
                "attributes": {
                  "realm_client": "false",
                  "client.use.lightweight.access.token.enabled": "true",
                  "post.logout.redirect.uris": "+",
                  "pkce.code.challenge.method": "S256"
                },
                "authenticationFlowBindingOverrides": {},
                "fullScopeAllowed": true,
                "nodeReRegistrationTimeout": 0,
                "protocolMappers": [
                  {
                    "name": "locale",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-usermodel-attribute-mapper",
                    "consentRequired": false,
                    "config": {
                      "introspection.token.claim": "true",
                      "userinfo.token.claim": "true",
                      "user.attribute": "locale",
                      "id.token.claim": "true",
                      "access.token.claim": "true",
                      "claim.name": "locale",
                      "jsonType.label": "String"
                    }
                  }
                ],
                "defaultClientScopes": [
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "organization",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "master-realm",
                "name": "master Realm",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": [],
                "webOrigins": [],
                "notBefore": 0,
                "bearerOnly": true,
                "consentRequired": false,
                "standardFlowEnabled": true,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": false,
                "publicClient": false,
                "frontchannelLogout": false,
                "attributes": {
                  "realm_client": "true"
                },
                "authenticationFlowBindingOverrides": {},
                "fullScopeAllowed": false,
                "nodeReRegistrationTimeout": 0,
                "defaultClientScopes": [
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "basic",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "organization",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "edgenode-a66efbee-4c28-1be7-1d07-88aedd66edd3",
                "name": "Edge Node [tenantID=e3c05ed6-6440-4167-b443-670d134841ec, UUID=a66efbee-4c28-1be7-1d07-88aedd66edd3]",
                "description": "Client to use by Edge Node [tenantID=e3c05ed6-6440-4167-b443-670d134841ec, UUID=a66efbee-4c28-1be7-1d07-88aedd66edd3], created by Onboarding Manager",
                "surrogateAuthRequired": false,
                "enabled": true,
                "alwaysDisplayInConsole": false,
                "clientAuthenticatorType": "client-secret",
                "redirectUris": [],
                "webOrigins": [],
                "notBefore": 0,
                "bearerOnly": false,
                "consentRequired": false,
                "standardFlowEnabled": false,
                "implicitFlowEnabled": false,
                "directAccessGrantsEnabled": false,
                "serviceAccountsEnabled": true,
                "publicClient": false,
                "frontchannelLogout": false,
                "protocol": "openid-connect",
                "attributes": {
                  "realm_client": "false",
                  "oidc.ciba.grant.enabled": "false",
                  "backchannel.logout.session.required": "true",
                  "oauth2.device.authorization.grant.enabled": "false",
                  "backchannel.logout.revoke.offline.tokens": "false"
                },
                "authenticationFlowBindingOverrides": {},
                "fullScopeAllowed": true,
                "nodeReRegistrationTimeout": -1,
                "defaultClientScopes": [
                  "service_account",
                  "web-origins",
                  "acr",
                  "roles",
                  "profile",
                  "email"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "microprofile-jwt"
                ]
              },
              {
                "clientId": "admin-cli",
                "name": "Admin CLI",
                "description": "Built-in admin CLI client for Keycloak tenant controller",
                "enabled": true,
                "clientAuthenticatorType": "client-secret",
                "publicClient": true,
                "directAccessGrantsEnabled": true,
                "protocol": "openid-connect",
                "attributes": {
                  "oidc.ciba.grant.enabled": "false",
                  "oauth2.device.authorization.grant.enabled": "false"
                },
                "fullScopeAllowed": true,
                "defaultClientScopes": [
                  "openid",
                  "profile",
                  "email",
                  "groups",
                  "web-origins",
                  "acr",
                  "roles",
                  "basic"
                ],
                "optionalClientScopes": [
                  "address",
                  "phone",
                  "offline_access",
                  "organization",
                  "microprofile-jwt"
                ]
              }
            ],
            "clientScopes": [
              {
                "name": "openid",
                "protocol": "openid-connect",
                "attributes": {
                  "include.in.token.scope": "true"
                },
                "protocolMappers": [
                  {
                    "name": "sub",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-sub-mapper",
                    "consentRequired": false,
                    "config": {
                      "userinfo.token.claim": "true",
                      "id.token.claim": "true",
                      "access.token.claim": "true"
                    }
                  },
                  {
                    "name": "aud",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-audience-mapper",
                    "consentRequired": false,
                    "config": {
                      "included.client.audience": "admin-cli",
                      "userinfo.token.claim": "true",
                      "id.token.claim": "true",
                      "access.token.claim": "true"
                    }
                  }
                ]
              },
              {
                "name": "profile",
                "protocol": "openid-connect",
                "attributes": {
                  "include.in.token.scope": "true"
                }
              },
              {
                "name": "email",
                "protocol": "openid-connect",
                "attributes": {
                  "include.in.token.scope": "true"
                }
              },
              {
                "name": "basic",
                "protocol": "openid-connect",
                "attributes": {
                  "include.in.token.scope": "true"
                }
              },
              {
                "name": "offline_access",
                "protocol": "openid-connect",
                "attributes": {
                  "include.in.token.scope": "true"
                }
              },
              {
                "name": "groups",
                "description": "Groups scope",
                "type": "Optional",
                "protocol": "openid-connect",
                "attributes": {
                  "include.in.token.scope": "true",
                  "display.on.consent.screen": "true"
                },
                "protocolMappers": [
                  {
                    "name": "groups",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-group-membership-mapper",
                    "consentRequired": false,
                    "config": {
                      "multivalued": "true",
                      "full.path": "false",
                      "id.token.claim": "true",
                      "access.token.claim": "true",
                      "claim.name": "groups",
                      "userinfo.token.claim": "true",
                      "jsonType.label": "String"
                    }
                  }
                ]
              },
              {
                "name": "roles",
                "description": "OpenID Connect scope for add user roles to the access token",
                "protocol": "openid-connect",
                "attributes": {
                  "include.in.token.scope": "true",
                  "display.on.consent.screen": "true",
                  "gui.order": "",
                  "consent.screen.text": '${roleScopeConsentText}'
                },
                "protocolMappers": [
                  {
                    "name": "realm roles",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-usermodel-realm-role-mapper",
                    "consentRequired": false,
                    "config": {
                      "multivalued": "true",
                      "userinfo.token.claim": "true",
                      "id.token.claim": "true",
                      "access.token.claim": "true",
                      "claim.name": "realm_access.roles",
                      "jsonType.label": "String"
                    }
                  },
                  {
                    "name": "client roles",
                    "protocol": "openid-connect",
                    "protocolMapper": "oidc-usermodel-client-role-mapper",
                    "consentRequired": false,
                    "config": {
                      "multivalued": "true",
                      "userinfo.token.claim": "true",
                      "id.token.claim": "true",
                      "access.token.claim": "true",
                      "claim.name": "resource_access.${client_id}.roles",
                      "jsonType.label": "String"
                    }
                  }
                ]
              }
            ],
            "groups": [
              {
                "name": "registry-app-admin-group",
                "path": "/registry-app-admin-group",
              },
              {
                "name": "registry-app-editor-group",
                "path": "/registry-app-editor-group",
              },
              {
                "name": "registry-app-viewer-group",
                "path": "/registry-app-viewer-group",
              },
              {
                "name": "apps-m2m-service-account",
                "path": "/apps-m2m-service-account",
                "realmRoles": [
                  "ao-m2m-rw",
                  "co-m2m-rw"
                ]
              },
              {
                "name": "org-admin-group",
                "path": "/org-admin-group",
                "realmRoles": [
                  "org-read-role",
                  "org-update-role",
                  "org-delete-role",
                  "org-write-role"
                ]
              },
              {
                "name": "sre-admin-group",
                "path": "/sre-admin-group",
                "realmRoles": [
                  "alrt-r"
                ],
                "clientRoles": {
                  "account": [
                    "view-profile",
                    "manage-account"
                  ],
                  "telemetry-client": [
                    "viewer"
                  ]
                }
              },
              {
                "name": "iam-admin-group",
                "path": "/iam-admin-group",
                "realmRoles": [
                  "admin",
                  "secrets-root-role"
                ],
                "clientRoles": {
                  "account": [
                    "view-profile",
                    "manage-account"
                  ],
                  "master-realm": [
                    "view-users",
                    "query-users",
                    "manage-clients"
                  ]
                }
              },
              {
                "name": "service-admin-group",
                "path": "/service-admin-group",
                "realmRoles": [
                  "alrt-rx-rw",
                  "rs-access-r",
                  "infra-manager-core-read-role",
                  "infra-manager-core-write-role",
                  "alrt-rw"
                ],
                "clientRoles": {
                  "account": [
                    "view-profile",
                    "manage-account"
                  ],
                  "master-realm": [
                    "view-users",
                    "query-users",
                    "manage-clients"
                  ],
                  "telemetry-client": [
                    "admin"
                  ],
                  "cluster-management-client": [
                    "restricted-role",
                    "standard-role",
                    "base-role"
                  ],
                  "registry-client": [
                    "registry-admin-role"
                  ]
                }
              },
              {
                "name": "edge-manager-group",
                "path": "/edge-manager-group",
                "realmRoles": [
                  "app-service-proxy-read-role",
                  "app-service-proxy-write-role",
                  "app-deployment-manager-read-role",
                  "app-deployment-manager-write-role",
                  "app-resource-manager-read-role",
                  "app-resource-manager-write-role",
                  "app-vm-console-write-role",
                  "catalog-publisher-read-role",
                  "catalog-publisher-write-role",
                  "catalog-other-read-role",
                  "catalog-other-write-role",
                  "catalog-restricted-read-role",
                  "catalog-restricted-write-role",
                  "clusters-read-role",
                  "clusters-write-role",
                  "cluster-templates-read-role",
                  "cluster-templates-write-role",
                  "cluster-artifacts-read-role",
                  "cluster-artifacts-write-role",
                  "infra-manager-core-read-role",
                  "alrt-rw"
                ],
                "clientRoles": {
                  "telemetry-client": [
                    "viewer"
                  ],
                  "cluster-management-client": [
                    "standard-role",
                    "base-role"
                  ],
                  "registry-client": [
                    "registry-editor-role"
                  ]
                }
              },
              {
                "name": "edge-operator-group",
                "path": "/edge-operator-group",
                "realmRoles": [
                  "app-service-proxy-read-role",
                  "app-service-proxy-write-role",
                  "app-deployment-manager-read-role",
                  "app-deployment-manager-write-role",
                  "app-resource-manager-read-role",
                  "app-resource-manager-write-role",
                  "app-vm-console-write-role",
                  "catalog-publisher-read-role",
                  "catalog-other-read-role",
                  "clusters-read-role",
                  "clusters-write-role",
                  "cluster-templates-read-role",
                  "cluster-artifacts-read-role",
                  "cluster-artifacts-write-role",
                  "infra-manager-core-read-role",
                  "alrt-r"
                ],
                "clientRoles": {
                  "telemetry-client": [
                    "viewer"
                  ],
                  "registry-client": [
                    "registry-viewer-role"
                  ]
                }
              },
              {
                "name": "host-manager-group",
                "path": "/host-manager-group",
                "realmRoles": [
                  "infra-manager-core-read-role",
                  "infra-manager-core-write-role"
                ],
                "clientRoles": {
                  "telemetry-client": [
                    "viewer"
                  ]
                }
              },
              {
                "name": "sre-group",
                "path": "/sre-group",
                "realmRoles": [
                  "alrt-r",
                  "clusters-read-role",
                  "clusters-write-role",
                  "cluster-templates-read-role",
                  "infra-manager-core-read-role"
                ],
                "clientRoles": {
                  "telemetry-client": [
                    "viewer"
                  ],
                  "cluster-management-client": [
                    "base-role",
                    "restricted-role"
                  ]
                }
              }
            ],
            "users": [
              {
                "username": "service-account-alerts-m2m-client",
                "enabled": true,
                "totp": false,
                "serviceAccountClientId": "alerts-m2m-client",
                "realmRoles": [
                  "default-roles-master"
                ],
                "clientRoles": {
                  "alerts-m2m-client": [
                    "uma_protection"
                  ],
                  "master-realm": [
                    "view-users"
                  ]
                },
                "notBefore": 0
              },
              {
                "username": "service-account-host-manager-m2m-client",
                "enabled": true,
                "totp": false,
                "serviceAccountClientId": "host-manager-m2m-client",
                "realmRoles": [
                  "default-roles-master",
                  "rs-access-r"
                ],
                "clientRoles": {
                  "host-manager-m2m-client": [
                    "uma_protection"
                  ],
                  "master-realm": [
                    "query-clients",
                    "manage-authorization",
                    "view-clients",
                    "view-users",
                    "create-client",
                    "manage-users",
                    "manage-clients",
                    "view-realm"
                  ]
                },
                "notBefore": 0
              },
              {
                "username": "service-account-co-manager-m2m-client",
                "enabled": true,
                "totp": false,
                "serviceAccountClientId": "co-manager-m2m-client",
                "realmRoles": [
                  "default-roles-master"
                ],
                "clientRoles": {
                  "co-manager-m2m-client": [
                    "uma_protection"
                  ],
                  "master-realm": [
                    "view-clients",
                    "manage-clients"
                  ]
                },
                "notBefore": 0,
                "groups": [
                  "/edge-manager-group",
                  "/apps-m2m-service-account"
                ]
              },
              {
                "username": "service-account-ktc-m2m-client",
                "enabled": true,
                "totp": false,
                "serviceAccountClientId": "ktc-m2m-client",
                "realmRoles": [
                  "admin",
                  "create-realm",
                  "default-roles-master",
                  "rs-access-r"
                ],
                "clientRoles": {
                  "ktc-m2m-client": [
                    "uma_protection"
                  ],
                  "master-realm": [
                    "query-clients",
                    "manage-authorization",
                    "view-clients",
                    "view-users",
                    "create-client",
                    "manage-users",
                    "manage-clients"
                  ]
                },
                "notBefore": 0
              },
              {
                "username": "service-account-3rd-party-host-manager-m2m-client",
                "enabled": true,
                "totp": false,
                "serviceAccountClientId": "3rd-party-host-manager-m2m-client",
                "realmRoles": [
                  "default-roles-master",
                  "rs-access-r"
                ],
                "clientRoles": {
                  "3rd-party-host-manager-m2m-client": [
                    "uma_protection"
                  ],
                  "master-realm": [
                    "query-clients",
                    "manage-authorization",
                    "view-clients",
                    "view-users",
                    "create-client",
                    "manage-users",
                    "manage-clients",
                    "view-realm",
                  ]
                },
                "notBefore": 0
              },
              {
                "username": "service-account-en-m2m-template-client",
                "enabled": true,
                "totp": false,
                "serviceAccountClientId": "en-m2m-template-client",
                "realmRoles": [
                  "default-roles-master",
                  "rs-access-r",
                  "en-agent-rw"
                ],
                "clientRoles": {
                  "en-m2m-template-client": [
                    "uma_protection"
                  ]
                },
                "notBefore": 0
              },
              {
                "username": "service-account-edge-manager-m2m-client",
                "enabled": true,
                "totp": false,
                "serviceAccountClientId": "edge-manager-m2m-client",
                "realmRoles": [
                  "default-roles-master"
                ],
                "clientRoles": {
                  "edge-manager-m2m-client": [
                    "uma_protection"
                  ]
                },
                "notBefore": 0,
                "groups": [
                  "/edge-manager-group",
                  "/apps-m2m-service-account"
                ]
              }
            ],
            "components": {
              "org.keycloak.keys.KeyProvider": [
                {
                  "name": "fallback-PS512",
                  "providerId": "rsa-generated",
                  "subComponents": {},
                  "config": {
                    "keySize": [
                      "4096"
                    ],
                    "active": [
                      "true"
                    ],
                    "priority": [
                      "-100"
                    ],
                    "enabled": [
                      "true"
                    ],
                    "algorithm": [
                      "PS512"
                    ]
                  }
                }
              ]
            }
          }
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.1.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "140"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/postgresql-cluster
  name: postgresql-cluster
  namespace: onprem
spec:
  destination:
    namespace: orch-database
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: cluster
    helm:
      releaseName: postgresql-cluster
      valuesObject:
        cluster:
          initdb:
            database: postgres
            localeCType: en_US.UTF-8
            localeCollate: en_US.UTF-8
            owner: orch-database-postgresql_user
            postInitSQL:
            - CREATE DATABASE "orch-app-app-orch-catalog";
            - BEGIN;
            - REVOKE CREATE ON SCHEMA public FROM PUBLIC;
            - REVOKE ALL ON DATABASE "orch-app-app-orch-catalog" FROM PUBLIC;
            - CREATE ROLE "orch-app-app-orch-catalog_user";
            - GRANT CONNECT ON DATABASE "orch-app-app-orch-catalog" TO "orch-app-app-orch-catalog_user";
            - GRANT ALL PRIVILEGES ON DATABASE "orch-app-app-orch-catalog" TO "orch-app-app-orch-catalog_user";
            - ALTER DATABASE "orch-app-app-orch-catalog" OWNER TO "orch-app-app-orch-catalog_user";
            - COMMIT;
            - CREATE DATABASE "orch-platform-platform-keycloak";
            - BEGIN;
            - REVOKE CREATE ON SCHEMA public FROM PUBLIC;
            - REVOKE ALL ON DATABASE "orch-platform-platform-keycloak" FROM PUBLIC;
            - CREATE ROLE "orch-platform-platform-keycloak_user";
            - GRANT CONNECT ON DATABASE "orch-platform-platform-keycloak" TO "orch-platform-platform-keycloak_user";
            - GRANT ALL PRIVILEGES ON DATABASE "orch-platform-platform-keycloak" TO
              "orch-platform-platform-keycloak_user";
            - ALTER DATABASE "orch-platform-platform-keycloak" OWNER TO "orch-platform-platform-keycloak_user";
            - COMMIT;
            - CREATE DATABASE "orch-platform-vault";
            - BEGIN;
            - REVOKE CREATE ON SCHEMA public FROM PUBLIC;
            - REVOKE ALL ON DATABASE "orch-platform-vault" FROM PUBLIC;
            - CREATE ROLE "orch-platform-vault_user";
            - GRANT CONNECT ON DATABASE "orch-platform-vault" TO "orch-platform-vault_user";
            - GRANT ALL PRIVILEGES ON DATABASE "orch-platform-vault" TO "orch-platform-vault_user";
            - ALTER DATABASE "orch-platform-vault" OWNER TO "orch-platform-vault_user";
            - COMMIT;
            - CREATE DATABASE "orch-infra-inventory";
            - BEGIN;
            - REVOKE CREATE ON SCHEMA public FROM PUBLIC;
            - REVOKE ALL ON DATABASE "orch-infra-inventory" FROM PUBLIC;
            - CREATE ROLE "orch-infra-inventory_user";
            - GRANT CONNECT ON DATABASE "orch-infra-inventory" TO "orch-infra-inventory_user";
            - GRANT ALL PRIVILEGES ON DATABASE "orch-infra-inventory" TO "orch-infra-inventory_user";
            - ALTER DATABASE "orch-infra-inventory" OWNER TO "orch-infra-inventory_user";
            - COMMIT;
            - CREATE DATABASE "orch-infra-alerting";
            - BEGIN;
            - REVOKE CREATE ON SCHEMA public FROM PUBLIC;
            - REVOKE ALL ON DATABASE "orch-infra-alerting" FROM PUBLIC;
            - CREATE ROLE "orch-infra-alerting_user";
            - GRANT CONNECT ON DATABASE "orch-infra-alerting" TO "orch-infra-alerting_user";
            - GRANT ALL PRIVILEGES ON DATABASE "orch-infra-alerting" TO "orch-infra-alerting_user";
            - ALTER DATABASE "orch-infra-alerting" OWNER TO "orch-infra-alerting_user";
            - COMMIT;
            - CREATE DATABASE "orch-iam-iam-tenancy";
            - BEGIN;
            - REVOKE CREATE ON SCHEMA public FROM PUBLIC;
            - REVOKE ALL ON DATABASE "orch-iam-iam-tenancy" FROM PUBLIC;
            - CREATE ROLE "orch-iam-iam-tenancy_user";
            - GRANT CONNECT ON DATABASE "orch-iam-iam-tenancy" TO "orch-iam-iam-tenancy_user";
            - GRANT ALL PRIVILEGES ON DATABASE "orch-iam-iam-tenancy" TO "orch-iam-iam-tenancy_user";
            - ALTER DATABASE "orch-iam-iam-tenancy" OWNER TO "orch-iam-iam-tenancy_user";
            - COMMIT;
            - CREATE DATABASE "orch-infra-mps";
            - BEGIN;
            - REVOKE CREATE ON SCHEMA public FROM PUBLIC;
            - REVOKE ALL ON DATABASE "orch-infra-mps" FROM PUBLIC;
            - CREATE ROLE "orch-infra-mps_user";
            - GRANT CONNECT ON DATABASE "orch-infra-mps" TO "orch-infra-mps_user";
            - GRANT ALL PRIVILEGES ON DATABASE "orch-infra-mps" TO "orch-infra-mps_user";
            - ALTER DATABASE "orch-infra-mps" OWNER TO "orch-infra-mps_user";
            - COMMIT;
            - CREATE DATABASE "orch-infra-rps";
            - BEGIN;
            - REVOKE CREATE ON SCHEMA public FROM PUBLIC;
            - REVOKE ALL ON DATABASE "orch-infra-rps" FROM PUBLIC;
            - CREATE ROLE "orch-infra-rps_user";
            - GRANT CONNECT ON DATABASE "orch-infra-rps" TO "orch-infra-rps_user";
            - GRANT ALL PRIVILEGES ON DATABASE "orch-infra-rps" TO "orch-infra-rps_user";
            - ALTER DATABASE "orch-infra-rps" OWNER TO "orch-infra-rps_user";
            - COMMIT;
            secret:
              name: orch-database-postgresql
          instances: 1
          postgresql:
            parameters:
              huge_pages: "off"
              max_connections: "200"
              shared_buffers: 256MB
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 256Mi
          roles:
          - ensure: present
            login: true
            name: orch-app-app-orch-catalog_user
            passwordSecret:
              name: orch-app-app-orch-catalog
          - ensure: present
            login: true
            name: orch-platform-platform-keycloak_user
            passwordSecret:
              name: orch-platform-platform-keycloak
          - ensure: present
            login: true
            name: orch-platform-vault_user
            passwordSecret:
              name: orch-platform-vault
          - ensure: present
            login: true
            name: orch-infra-inventory_user
            passwordSecret:
              name: orch-infra-inventory
          - ensure: present
            login: true
            name: orch-infra-alerting_user
            passwordSecret:
              name: orch-infra-alerting
          - ensure: present
            login: true
            name: orch-iam-iam-tenancy_user
            passwordSecret:
              name: orch-iam-iam-tenancy
          - ensure: present
            login: true
            name: orch-infra-mps_user
            passwordSecret:
              name: orch-infra-mps
          - ensure: present
            login: true
            name: orch-infra-rps_user
            passwordSecret:
              name: orch-infra-rps
          storage:
            size: 8Gi
        mode: standalone
        namespace: orch-database
        type: postgresql
        version:
          postgresql: "17"
    repoURL: ghcr.io/cloudnative-pg/charts
    targetRevision: 0.3.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/postgresql-operator
  name: postgresql-operator
  namespace: onprem
spec:
  destination:
    namespace: postgresql-operator
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: cloudnative-pg
    helm:
      releaseName: postgresql-operator
      valuesObject:
        namespace: postgresql-operator
        replicaCount: 1
    repoURL: ghcr.io/cloudnative-pg/charts
    targetRevision: 0.26.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - ServerSideApply=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "130"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/postgresql-secrets
  name: postgresql-secrets
  namespace: onprem
spec:
  destination:
    namespace: orch-database
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: ""
    jsonPointers:
    - /data/PGPASSWORD
    kind: Secret
    name: app-orch-catalog-local-postgresql
    namespace: orch-app
  - group: ""
    jsonPointers:
    - /data/password
    kind: Secret
    name: orch-app-app-orch-catalog
    namespace: orch-database
  - group: ""
    jsonPointers:
    - /data/PGPASSWORD
    kind: Secret
    name: platform-keycloak-local-postgresql
    namespace: orch-platform
  - group: ""
    jsonPointers:
    - /data/password
    kind: Secret
    name: orch-platform-platform-keycloak
    namespace: orch-database
  - group: ""
    jsonPointers:
    - /data/PGPASSWORD
    kind: Secret
    name: vault-local-postgresql
    namespace: orch-platform
  - group: ""
    jsonPointers:
    - /data/password
    kind: Secret
    name: orch-platform-vault
    namespace: orch-database
  - group: ""
    jsonPointers:
    - /data/PGPASSWORD
    kind: Secret
    name: inventory-local-postgresql
    namespace: orch-infra
  - group: ""
    jsonPointers:
    - /data/password
    kind: Secret
    name: orch-infra-inventory
    namespace: orch-database
  - group: ""
    jsonPointers:
    - /data/PGPASSWORD
    kind: Secret
    name: alerting-local-postgresql
    namespace: orch-infra
  - group: ""
    jsonPointers:
    - /data/password
    kind: Secret
    name: orch-infra-alerting
    namespace: orch-database
  - group: ""
    jsonPointers:
    - /data/PGPASSWORD
    kind: Secret
    name: iam-tenancy-local-postgresql
    namespace: orch-iam
  - group: ""
    jsonPointers:
    - /data/password
    kind: Secret
    name: orch-iam-iam-tenancy
    namespace: orch-database
  - group: ""
    jsonPointers:
    - /data/PGPASSWORD
    kind: Secret
    name: mps-local-postgresql
    namespace: orch-infra
  - group: ""
    jsonPointers:
    - /data/password
    kind: Secret
    name: orch-infra-mps
    namespace: orch-database
  - group: ""
    jsonPointers:
    - /data/PGPASSWORD
    kind: Secret
    name: rps-local-postgresql
    namespace: orch-infra
  - group: ""
    jsonPointers:
    - /data/password
    kind: Secret
    name: orch-infra-rps
    namespace: orch-database
  project: onprem
  sources:
  - chart: common/charts/postgresql-secrets
    helm:
      releaseName: postgresql-secrets
      valuesObject:
        annotations:
          cnpg.io/reload: "false"
        databases:
        - name: app-orch-catalog
          namespace: orch-app
        - name: platform-keycloak
          namespace: orch-platform
        - name: vault
          namespace: orch-platform
        - name: inventory
          namespace: orch-infra
        - name: alerting
          namespace: orch-infra
        - name: iam-tenancy
          namespace: orch-iam
        - name: mps
          namespace: orch-infra
        - name: rps
          namespace: orch-infra
        host: postgresql-cluster-rw.orch-database
        namespace: orch-database
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - RespectIgnoreDifferences=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/prometheus-crd
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: prometheus-crd
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: prometheus-operator-crds
    helm:
      releaseName: prometheus-crd
      valuesObject: {}
    repoURL: https://prometheus-community.github.io/helm-charts
    targetRevision: 24.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - ServerSideApply=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "110"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/reloader
  name: reloader
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: reloader
    helm:
      releaseName: reloader
      valuesObject:
        reloader:
          deployment:
            containerSecurityContext:
              allowPrivilegeEscalation: false
              capabilities:
                drop:
                - ALL
              readOnlyRootFilesystem: true
              seccompProfile:
                type: RuntimeDefault
            resources:
              limits:
                cpu: "64"
                memory: 64Gi
              requests:
                cpu: 1m
                memory: 1Mi
            securityContext:
              runAsNonRoot: true
              runAsUser: 65534
          watchGlobally: true
    repoURL: https://stakater.github.io/stakater-charts
    targetRevision: 2.2.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "170"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/rs-proxy
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: rs-proxy
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/rs-proxy
    helm:
      releaseName: rs-proxy
      valuesObject:
        env: null
        externalSecretsApiGroup: external-secrets.io/v1
        proxyTargetFiles: files-rs.edgeorchestration.intel.com
        proxyTargetRegistry: registry-rs.edgeorchestration.intel.com
        refreshInterval: 10m
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        withReleaseServiceToken: false
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1300"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/secret-wait-tls-boots
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: secret-wait-tls-boots
  namespace: onprem
spec:
  destination:
    namespace: orch-boots
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/secret-wait
    helm:
      releaseName: secret-wait-tls-boots
      valuesObject:
        resources: null
        secret-wait:
          image: alpine/kubectl:1.34.1
        secretName: tls-boots
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "170"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/secret-wait-tls-orch
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: secret-wait-tls-orch
  namespace: onprem
spec:
  destination:
    namespace: orch-gateway
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/secret-wait
    helm:
      releaseName: secret-wait-tls-orch
      valuesObject:
        resources: null
        secret-wait:
          image: alpine/kubectl:1.34.1
        secretName: tls-orch
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "160"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/secrets-config
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: secrets-config
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/secrets-config
    helm:
      releaseName: secrets-config
      valuesObject:
        auth:
          oidc:
            idPAddr: http://platform-keycloak.orch-platform.svc
            idPDiscoveryURL: http://platform-keycloak.orch-platform.svc/realms/master
            roleMaxTTL: 1h
          orchSvcs:
            roleMaxTTL: 1h
        autoInit: true
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
          repository: common/secrets-config
        imagePullSecrets: null
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 3.0.6
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "160"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/self-signed-cert
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: self-signed-cert
  namespace: onprem
spec:
  destination:
    namespace: cert-manager
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: cert-manager.io
    jsonPointers:
    - /spec/isCA
    kind: Certificate
  project: onprem
  sources:
  - chart: common/charts/self-signed-cert
    helm:
      releaseName: self-signed-cert
      valuesObject:
        certDomain: cluster.onprem
        generateOrchCert: true
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 4.0.11
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - Replace=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "2000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/sre-exporter
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: sre-exporter
  namespace: onprem
spec:
  destination:
    namespace: orch-sre
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: ""
    jsonPointers:
    - /data/sre-exporter-edge-node.json
    kind: ConfigMap
    name: sre-exporter-config
    namespace: orch-sre
  - group: ""
    jsonPointers:
    - /metadata/annotations/configMapHash
    kind: Pod
    name: '*'
    namespace: orch-sre
  project: onprem
  sources:
  - chart: o11y/charts/sre-exporter
    helm:
      releaseName: sre-exporter
      valuesObject:
        configReloader:
          o11yTenantController:
            namespace: orch-platform
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
        externalSecretsApiGroup: external-secrets.io/v1
        imagePullSecrets: null
        imageRegistry: registry-rs.edgeorchestration.intel.com/edge-orch
        metricsExporter:
          customerLabelValue: local
          mimirScopeOrgId: orchestrator-system
          mimirScopeOrgIdEdgeNode: edgenode-system
          queryURI: http://orchestrator-observability-mimir-gateway.orch-platform.svc.cluster.local:8181/prometheus
          queryURIEdgeNode: http://edgenode-observability-mimir-gateway.orch-infra.svc.cluster.local:8181/prometheus
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          vaultInstances:
          - -vaultURI=vault-0
          vaultNamespace: orch-platform
        otelCollector:
          basicAuth:
            enabled: true
          externalSecret:
            enabled: false
            providerWebhookQueryKey: name
            providerWebhookUrl: http://aws-sm-proxy.orch-secret.svc.cluster.local:8080/aws-secret
            refreshInterval: 5m
          proxy:
            enabled: false
          pushInterval: 30s
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          tls:
            enabled: false
        replicaCount: 1
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 0.9.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - RespectIgnoreDifferences=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1200"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/tenancy-api-mapping
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: tenancy-api-mapping
  namespace: onprem
spec:
  destination:
    namespace: orch-iam
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/tenancy-api-mapping
    helm:
      releaseName: tenancy-api-mapping
      valuesObject:
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
        imagePullSecrets: null
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    - Replace=true
    - Force=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1200"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/tenancy-datamodel
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: tenancy-datamodel
  namespace: onprem
spec:
  destination:
    namespace: orch-iam
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/tenancy-datamodel
    helm:
      releaseName: tenancy-datamodel
      valuesObject:
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
          repository: common/tenancy-datamodel
        imagePullSecrets: null
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1200"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/tenancy-manager
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: tenancy-manager
  namespace: onprem
spec:
  destination:
    namespace: orch-iam
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/tenancy-manager
    helm:
      releaseName: tenancy-manager
      valuesObject:
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
          repository: common/tenancy-manager
        imagePullSecrets: null
        resources: null
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1300"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/token-fs
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: token-fs
  namespace: onprem
spec:
  destination:
    namespace: orch-secret
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/token-fs
    helm:
      releaseName: token-fs
      valuesObject:
        emptyReleaseServiceToken: "true"
        image:
          registry: registry-rs.edgeorchestration.intel.com/edge-orch
          repository: common/token-fs
        imagePullSecrets: null
        orchSecretName: tls-orch
        releaseMatchHost: Host(`release.cluster.onprem`)
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        tlsOption: gateway-tls
        traefikApiGroup: traefik.io/v1alpha1
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1100"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/traefik
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: traefik
  namespace: onprem
spec:
  destination:
    namespace: orch-gateway
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: traefik
    helm:
      releaseName: traefik
      valuesObject:
        additionalArguments:
        - --experimental.localPlugins.jwt.moduleName=github.com/team-carepay/traefik-jwt-plugin
        additionalVolumeMounts:
        - mountPath: ./plugins-local/src/github.com/team-carepay/traefik-jwt-plugin/
          name: jwt-plugin
        deployment:
          podAnnotations:
            traffic.sidecar.istio.io/excludeInboundPorts: 8000,8443,8080,4433
            traffic.sidecar.istio.io/excludeOutboundIPRanges: 10.96.0.1/32
            traffic.sidecar.istio.io/excludeOutboundPorts: "4433"
        globalArguments: null
        ingressRoute:
          dashboard:
            enabled: false
        logs:
          access:
            enabled: true
            format: json
          general:
            format: json
        metrics:
          prometheus:
            buckets: 0.1,0.3,0.6,0.9,1.2,1.5,2.0,2.5,5.0,10.0
            service:
              enabled: true
        nodeSelector: {}
        ports:
          tcpamt:
            expose:
              default: true
            exposedPort: 4433
            middlewares:
            - orch-gateway-tcp-rate-limit@kubernetescrd
            port: 4433
            protocol: TCP
          web:
            expose:
              default: false
          websecure:
            middlewares:
            - orch-gateway-rate-limit@kubernetescrd
            - orch-gateway-cors@kubernetescrd
            nodePort: 30443
        providers:
          kubernetesCRD:
            allowCrossNamespace: true
            namespaces:
            - default
            - orch-gateway
            - orch-platform
            - orch-app
            - orch-infra
            - orch-cluster
            - orch-harbor
            - cattle-system
            - connect-gateway
            - orch-ui
            - orch-secret
            - orch-iam
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          seccompProfile:
            type: RuntimeDefault
        service:
          annotations:
            metallb.universe.tf/address-pool: traefik
          type: LoadBalancer
        tolerations: []
        volumes:
        - mountPath: ./traefik-jwt-plugin/
          name: jwt-plugin
          type: configMap
    repoURL: https://helm.traefik.io/traefik
    targetRevision: 37.2.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1200"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/traefik-extra-objects
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: traefik-extra-objects
  namespace: onprem
spec:
  destination:
    namespace: orch-gateway
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/traefik-extra-objects
    helm:
      releaseName: traefik-extra-objects
      valuesObject:
        clusterOrchNodeMatchHost: Host(`cluster-orch-node.cluster.onprem`)
        connectCSPs:
        - https://keycloak.cluster.onprem
        - wss://vnc.cluster.onprem
        - https://app-service-proxy.cluster.onprem
        - https://app-orch.cluster.onprem
        - https://api.cluster.onprem
        - https://cluster-orch.cluster.onprem
        - https://metadata.cluster.onprem
        - https://alerting-monitor.cluster.onprem
        connectCSPsAppOrch:
        - https://keycloak.cluster.onprem
        cors:
          allowedOrigins:
          - https://cluster.onprem
          - https://web-ui.cluster.onprem
          enabled: true
        fleetMatchHost: Host(`fleet.cluster.onprem`)
        giteaMatchHost: Host(`gitea.cluster.onprem`)
        harborOciMatchHost: Host(`registry-oci.cluster.onprem`)
        keycloakJwksPath: /realms/master/protocol/openid-connect/certs
        keycloakJwksUrl: http://platform-keycloak.orch-platform.svc
        keycloakMatchHost: Host(`keycloak.cluster.onprem`)
        keycloakServicePort: 8080
        logsNodeMatchHost: Host(`logs-node.cluster.onprem`)
        metricsNodeMatchHost: Host(`metrics-node.cluster.onprem`)
        observabilityAdminMatchHost: Host(`observability-admin.cluster.onprem`)
        observabilityMatchHost: Host(`observability-ui.cluster.onprem`)
        orchSecretName: tls-orch
        rootMatchHost: Host(`cluster.onprem`)
        scriptSources:
        - https://app-service-proxy.cluster.onprem
        tlsOption: gateway-tls
        traefikApiGroup: traefik.io/v1alpha1
        vaultMatchHost: Host(`vault.cluster.onprem`)
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 26.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/traefik-pre
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: traefik-pre
  namespace: onprem
spec:
  destination:
    namespace: orch-gateway
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/traefik-pre
    helm:
      releaseName: traefik-pre
      valuesObject: {}
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 3.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "160"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/vault
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: vault
  namespace: onprem
spec:
  destination:
    namespace: orch-platform
    server: https://kubernetes.default.svc
  ignoreDifferences:
  - group: admissionregistration.k8s.io
    jqPathExpressions:
    - .webhooks[]?.clientConfig.caBundle
    kind: MutatingWebhookConfiguration
  project: onprem
  sources:
  - chart: vault
    helm:
      releaseName: vault
      valuesObject:
        containersecuritycontext:
          allowprivilegeescalation: false
        global:
          imagePullSecrets: null
        injector:
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          securityContext:
            container:
              allowPrivilegeEscalation: false
              capabilities:
                drop:
                - ALL
              seccompProfile:
                type: RuntimeDefault
          strategy:
            type: Recreate
        server:
          dataStorage:
            enabled: false
          extraArgs: -config=/vault/userconfig/vault-storage-config/storage.hcl
          extraInitContainers:
          - args:
            - echo "storage \"postgresql\" { connection_url = \"postgres://$PGUSER:$PGPASSWORD@$PGHOST:$PGPORT/$PGDATABASE\"
              ha_enabled=\"$HA_ENABLED\" }" > /vault/userconfig/vault-storage-config/storage.hcl
            command:
            - sh
            - -c
            env:
            - name: PGUSER
              valueFrom:
                secretKeyRef:
                  key: PGUSER
                  name: vault-local-postgresql
            - name: PGPASSWORD
              valueFrom:
                secretKeyRef:
                  key: PGPASSWORD
                  name: vault-local-postgresql
            - name: PGHOST
              valueFrom:
                secretKeyRef:
                  key: PGHOST
                  name: vault-local-postgresql
            - name: PGPORT
              valueFrom:
                secretKeyRef:
                  key: PGPORT
                  name: vault-local-postgresql
            - name: PGDATABASE
              valueFrom:
                secretKeyRef:
                  key: PGDATABASE
                  name: vault-local-postgresql
            - name: HA_ENABLED
              value: "false"
            image: alpine:3.22.2
            name: storage-config
            securityContext:
              allowPrivilegeEscalation: false
              capabilities:
                drop:
                - ALL
              seccompProfile:
                type: RuntimeDefault
            volumeMounts:
            - mountPath: /vault/userconfig/vault-storage-config
              name: vault-storage-config
          - args:
            - |
              EXIST=$(psql -h $PGHOST -p $PGPORT -U $PGUSER -d $PGDATABASE -t -A -c \
                "SELECT EXISTS (SELECT FROM pg_tables WHERE tablename  = 'vault_kv_store' OR tablename = 'vault_ha_locks');"
              )
              if [[ $EXIST == "t" ]]; then
                echo "Tables already exist, skipping initialization"
                exit 0
              fi

              psql -h $PGHOST -p $PGPORT -U $PGUSER -d $PGDATABASE -c \
              "CREATE TABLE vault_kv_store (
                parent_path TEXT COLLATE \"C\" NOT NULL,
                path        TEXT COLLATE \"C\",
                key         TEXT COLLATE \"C\",
                value       BYTEA,
                CONSTRAINT pkey PRIMARY KEY (path, key)
              );
              CREATE INDEX parent_path_idx ON vault_kv_store (parent_path);
              CREATE TABLE vault_ha_locks (
                ha_key      TEXT COLLATE \"C\" NOT NULL,
                ha_identity TEXT COLLATE \"C\" NOT NULL,
                ha_value    TEXT COLLATE \"C\",
                valid_until TIMESTAMP WITH TIME ZONE NOT NULL,
                CONSTRAINT ha_key PRIMARY KEY (ha_key)
              );"
            command:
            - bash
            - -x
            - -c
            env:
            - name: PGUSER
              valueFrom:
                secretKeyRef:
                  key: PGUSER
                  name: vault-local-postgresql
            - name: PGPASSWORD
              valueFrom:
                secretKeyRef:
                  key: PGPASSWORD
                  name: vault-local-postgresql
            - name: PGHOST
              valueFrom:
                secretKeyRef:
                  key: PGHOST
                  name: vault-local-postgresql
            - name: PGPORT
              valueFrom:
                secretKeyRef:
                  key: PGPORT
                  name: vault-local-postgresql
            - name: PGDATABASE
              valueFrom:
                secretKeyRef:
                  key: PGDATABASE
                  name: vault-local-postgresql
            image: library/postgres:14.19-alpine3.22
            name: init-table
            securityContext:
              allowPrivilegeEscalation: false
              capabilities:
                drop:
                - ALL
              seccompProfile:
                type: RuntimeDefault
          image:
            pullPolicy: IfNotPresent
            tag: 1.20.4
          logLevel: info
          resources:
            limits:
              cpu: "64"
              memory: 64Gi
            requests:
              cpu: 1m
              memory: 1Mi
          standalone:
            config: |
              ui = true
              # Internal cluster traffic will leverage the mTLS service mesh
              listener "tcp" {
                tls_disable = 1

                address = "[::]:8200"
                cluster_address = "[::]:8201"
              }
          statefulSet:
            securityContext:
              container:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                  - ALL
                seccompProfile:
                  type: RuntimeDefault
          volumeMounts:
          - mountPath: /vault/userconfig/vault-storage-config
            name: vault-storage-config
            readOnly: true
          volumes:
          - emptyDir: {}
            name: vault-storage-config
    repoURL: https://helm.releases.hashicorp.com
    targetRevision: 0.31.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "110"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/wait-istio-job
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: wait-istio-job
  namespace: onprem
spec:
  destination:
    namespace: ns-label
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: common/charts/job-wait
    helm:
      releaseName: wait-istio-job
      valuesObject:
        jobPrefix: namespace-label
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 25.2.3
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "3000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/web-ui-admin
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: web-ui-admin
  namespace: onprem
spec:
  destination:
    namespace: orch-ui
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: orch-ui/charts/orch-ui-admin
    helm:
      releaseName: web-ui
      valuesObject:
        global:
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 3.2.4
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "3000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/web-ui-app-orch
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: web-ui-app-orch
  namespace: onprem
spec:
  destination:
    namespace: orch-ui
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: orch-ui/charts/orch-ui-app-orch
    helm:
      releaseName: web-ui
      valuesObject:
        global:
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 4.0.2
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "3000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/web-ui-cluster-orch
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: web-ui-cluster-orch
  namespace: onprem
spec:
  destination:
    namespace: orch-ui
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: orch-ui/charts/orch-ui-cluster-orch
    helm:
      releaseName: web-ui
      valuesObject:
        global:
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 4.0.0
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "3000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/web-ui-infra
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: web-ui-infra
  namespace: onprem
spec:
  destination:
    namespace: orch-ui
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: orch-ui/charts/orch-ui-infra
    helm:
      releaseName: web-ui
      valuesObject:
        api:
          alertManager: https://alerting-monitor.cluster.onprem
          appDeploymentManger: https://api.cluster.onprem
          appResourceManger: https://api.cluster.onprem
          catalog: https://api.cluster.onprem
          clusterOrch: https://api.cluster.onprem
          infraManager: https://api.cluster.onprem
          metadataBroker: https://api.cluster.onprem
          mps: https://api.cluster.onprem
          rps: https://api.cluster.onprem
          tenantManager: https://api.cluster.onprem
        global:
          auth:
            enabled: true
            keycloak:
              client_id: webui-client
              realm: master
              url: https://keycloak.cluster.onprem
          observability:
            url: https://observability-ui.cluster.onprem
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
          session_timeout: 3600
        header:
          title: Edge Infrastructure Manager
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        service:
          traefik:
            baseHostname: Host(`cluster.onprem`)
            enabled: false
            hostname: Host(`web-ui.cluster.onprem`)
            options:
              name: gateway-tls
          type: ClusterIP
        traefikApiGroup: traefik.io/v1alpha1
        versions:
          orchestrator: 2026.0.0-dev
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 3.2.17
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "3000"
    argocd.argoproj.io/tracking-id: onprem_root-app:argoproj.io/Application:onprem/web-ui-root
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  name: web-ui-root
  namespace: onprem
spec:
  destination:
    namespace: orch-ui
    server: https://kubernetes.default.svc
  project: onprem
  sources:
  - chart: orch-ui/charts/orch-ui-root
    helm:
      releaseName: web-ui
      valuesObject:
        api:
          alertManager: https://api.cluster.onprem
          appDeploymentManger: https://api.cluster.onprem
          appResourceManger: https://api.cluster.onprem
          catalog: https://api.cluster.onprem
          clusterOrch: https://api.cluster.onprem
          infraManager: https://api.cluster.onprem
          metadataBroker: https://api.cluster.onprem
          mps: https://api.cluster.onprem
          rps: https://api.cluster.onprem
          tenantManager: https://api.cluster.onprem
        global:
          auth:
            enabled: true
            keycloak:
              client_id: webui-client
              realm: master
              url: https://keycloak.cluster.onprem
          observability:
            url: https://observability-ui.cluster.onprem
          registry:
            imagePullSecrets: null
            name: registry-rs.edgeorchestration.intel.com/edge-orch
          session_timeout: 3600
        header:
          title: Edge Orchestrator
        resources:
          limits:
            cpu: "64"
            memory: 64Gi
          requests:
            cpu: 1m
            memory: 1Mi
        service:
          traefik:
            baseHostname: Host(`cluster.onprem`)
            enabled: true
            hostname: Host(`web-ui.cluster.onprem`)
            namespace: orch-gateway
            options:
              name: gateway-tls
          type: ClusterIP
        traefikApiGroup: traefik.io/v1alpha1
        versions:
          orchestrator: 2026.0.0-dev
    repoURL: registry-rs.edgeorchestration.intel.com/edge-orch
    targetRevision: 4.0.1
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m0s
      limit: 5
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true

=== END onprem/root-app Manifests ===
=== BEGIN onprem/root-app Diff ===
=== END onprem/root-app Diff ===
